(self.webpackChunk_canva_web=self.webpackChunk_canva_web||[]).push([[92640],{1408:(t,e,r)=>{"use strict";r.d(e,{X:()=>i});var i=function(t){return t&&"number"==typeof t.length&&"function"!=typeof t}},37186:(t,e,r)=>{"use strict";r.d(e,{F:()=>n});var i=r(599884),n=function(t){return function(e){return t.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,i.T),e}}},59329:(t,e,r)=>{"use strict";r.d(e,{r:()=>n});var i=r(998083),n=function(t){function e(e,r){return t.call(this)||this}return i.C6(e,t),e.prototype.schedule=function(t,e){return void 0===e&&(e=0),this},e}(r(997752).y)},72231:(t,e,r)=>{"use strict";function i(t){return!!t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}r.d(e,{y:()=>i})},124105:(t,e,r)=>{"use strict";r.d(e,{x:()=>a});var i=r(226260),n=r(997752),s=r(977305);function a(t,e){return new i.c((function(r){var i=new n.y;return i.add(e.schedule((function(){var n=t[s.s]();i.add(n.subscribe({next:function(t){i.add(e.schedule((function(){return r.next(t)})))},error:function(t){i.add(e.schedule((function(){return r.error(t)})))},complete:function(){i.add(e.schedule((function(){return r.complete()})))}}))}))),i}))}},168287:(t,e,r)=>{"use strict";r.d(e,{P:()=>s});var i=r(226260),n=r(997752);function s(t,e){return new i.c((function(r){var i=new n.y;return i.add(e.schedule((function(){return t.then((function(t){i.add(e.schedule((function(){r.next(t),i.add(e.schedule((function(){return r.complete()})))})))}),(function(t){i.add(e.schedule((function(){return r.error(t)})))}))}))),i}))}},190418:(t,e,r)=>{"use strict";r.d(e,{X:()=>n});var i=r(977305),n=function(t){return function(e){var r=t[i.s]();if("function"!=typeof r.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return r.subscribe(e)}}},211794:(t,e,r)=>{"use strict";function i(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}r.d(e,{lJ:()=>n});var n=i()},212943:(t,e,r)=>{"use strict";r.d(e,{H:()=>a});var i=r(226260),n=r(664191),s=r(502678);function a(t,e){return e?(0,s.c)(t,e):t instanceof i.c?t:new i.c((0,n.i)(t))}},237157:(t,e,r)=>{"use strict";r.d(e,{R:()=>n});var i=r(998083),n=function(t){function e(e,r){var i=t.call(this,e,r)||this;return i.scheduler=e,i.work=r,i.pending=!1,i}return i.C6(e,t),e.prototype.schedule=function(t,e){if(void 0===e&&(e=0),this.closed)return this;this.state=t;var r=this.id,i=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(i,r,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(i,this.id,e),this},e.prototype.requestAsyncId=function(t,e,r){return void 0===r&&(r=0),setInterval(t.flush.bind(t,this),r)},e.prototype.recycleAsyncId=function(t,e,r){if(void 0===r&&(r=0),null!==r&&this.delay===r&&!1===this.pending)return e;clearInterval(e)},e.prototype.execute=function(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var r=this._execute(t,e);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(t,e){var r=!1,i=void 0;try{this.work(t)}catch(n){r=!0,i=!!n&&n||new Error(n)}if(r)return this.unsubscribe(),i},e.prototype._unsubscribe=function(){var t=this.id,e=this.scheduler,r=e.actions,i=r.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==i&&r.splice(i,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null},e}(r(59329).r)},291650:(t,e,r)=>{"use strict";r.d(e,{I:()=>s,w:()=>n});var i=r(226260),n=new i.c((function(t){return t.complete()}));function s(t){return t?function(t){return new i.c((function(e){return t.schedule((function(){return e.complete()}))}))}(t):n}},316440:(t,e,r)=>{"use strict";r.d(e,{s:()=>o});var i=r(998083),n=r(335679),s=r(936791),a=r(291650);function o(t){return function(e){return 0===t?(0,a.I)():e.lift(new c(t))}}var c=function(){function t(t){if(this.total=t,this.total<0)throw new s.k}return t.prototype.call=function(t,e){return e.subscribe(new h(t,this.total))},t}(),h=function(t){function e(e,r){var i=t.call(this,e)||this;return i.total=r,i.count=0,i}return i.C6(e,t),e.prototype._next=function(t){var e=this.total,r=++this.count;r<=e&&(this.destination.next(t),r===e&&(this.destination.complete(),this.unsubscribe()))},e}(n.v)},317261:(t,e,r)=>{"use strict";r.d(e,{G:()=>i});var i=function(){function t(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return t.prototype=Object.create(Error.prototype),t}()},322546:(t,e,r)=>{"use strict";r.d(e,{of:()=>a});var i=r(453535),n=r(550742),s=r(363295);function a(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=t[t.length-1];return(0,i.m)(r)?(t.pop(),(0,s.V)(t,r)):(0,n.c)(t)}},363295:(t,e,r)=>{"use strict";r.d(e,{V:()=>s});var i=r(226260),n=r(997752);function s(t,e){return new i.c((function(r){var i=new n.y,s=0;return i.add(e.schedule((function(){s!==t.length?(r.next(t[s++]),r.closed||i.add(this.schedule())):r.complete()}))),i}))}},410826:(t,e,r)=>{"use strict";r.d(e,{x:()=>n});var i=r(211794);function n(t){return t&&"function"==typeof t[i.lJ]}},426242:(t,e,r)=>{"use strict";r.d(e,{S:()=>a});var i=r(226260),n=r(997752),s=r(211794);function a(t,e){if(!t)throw new Error("Iterable cannot be null");return new i.c((function(r){var i,a=new n.y;return a.add((function(){i&&"function"==typeof i.return&&i.return()})),a.add(e.schedule((function(){i=t[s.lJ](),a.add(e.schedule((function(){if(!r.closed){var t,e;try{var n=i.next();t=n.value,e=n.done}catch(s){return void r.error(s)}e?r.complete():(r.next(t),this.schedule())}})))}))),a}))}},447524:(t,e)=>{"use strict";Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});class r extends Error{}class i extends r{}class n extends r{}class s extends r{}class a extends r{}class o extends r{}class c extends r{}class h extends r{constructor(t){super(`unhandled case: ${JSON.stringify(t)}`)}}let l=0;function u(){return l++}function f(t){return null!=t}function d(t){return t instanceof Int8Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Float32Array}function E(t){switch(t){case"i8":return 5120;case"u8":return 5121;case"i16":return 5122;case"u16":return 5123;case"i32":return 5124;case"u32":return 5125;case"f32":return 5126;default:throw new h(t)}}const m={FLOAT:{type:"float",name:"float",length:1},VEC2:{type:"float",name:"vec2",length:2},VEC3:{type:"float",name:"vec3",length:3},VEC4:{type:"float",name:"vec4",length:4}},T={MAT2:{type:"matrix",name:"mat2",length:4},MAT3:{type:"matrix",name:"mat3",length:9},MAT4:{type:"matrix",name:"mat4",length:16}},g={INT:{type:"int",name:"int",length:1},IVEC2:{type:"int",name:"ivec2",length:2},IVEC3:{type:"int",name:"ivec3",length:3},IVEC4:{type:"int",name:"ivec4",length:4},SAMPLER2D:{type:"int",name:"sampler2D",length:1}},v=new Map([[5126,m.FLOAT],[35664,m.VEC2],[35665,m.VEC3],[35666,m.VEC4],[35674,T.MAT2],[35675,T.MAT3],[35676,T.MAT4],[5124,g.INT],[35667,g.IVEC2],[35668,g.IVEC3],[35669,g.IVEC4],[35678,g.SAMPLER2D]]);class p{constructor(t){var e;this.id=u(),this.source=t,t instanceof ArrayBuffer?this.dataType="f32":(e=t,"undefined"!=typeof SharedArrayBuffer&&e instanceof SharedArrayBuffer?this.dataType="f32":this.dataType=function(t){if(t instanceof Float32Array)return"f32";if(t instanceof Uint8Array)return"u8";if(t instanceof Int32Array)return"i32";if(t instanceof Uint32Array)return"u32";if(t instanceof Uint8ClampedArray)return"u8";if(t instanceof Int8Array)return"i8";if(t instanceof Int16Array)return"i16";if(t instanceof Uint16Array)return"u16";throw new h(t)}(t)),this.length=t.byteLength/function(t){switch(t){case"i8":case"u8":return 1;case"i16":case"u16":return 2;case"i32":case"u32":case"f32":return 4;default:throw new h(t)}}(this.dataType)}}class A extends p{constructor(){super(...arguments),this.resourceType="buffer"}}class _ extends p{constructor(){super(...arguments),this.resourceType="elements"}}const b={points:0,lines:1,"line loop":2,"line strip":3,triangles:4,"triangle strip":5,"triangle fan":6},R={zero:0,one:1,"src color":768,"one minus src color":769,"dst color":774,"one minus dst color":775,"src alpha":770,"one minus src alpha":771,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},w={front:1028,back:1029,"front and back":1032},x={cw:2304,ccw:2305},y={add:32774,subtract:32778,"reverse subtract":32779},F={source:"one",destination:"zero",equation:"add"};const M={never:512,less:513,equal:514,lequal:515,greater:516,notequal:517,gequal:518,always:519};class S{constructor({primitive:t="triangles",shader:e,attributes:r,indices:i,count:n=0,instances:s,uniforms:a={},textures:o={},blend:c,depthTest:h,cullFace:l,frontFace:u,renderTarget:f}){var E;this.primitive=b[t],this.shader=e,this.attributes=function(t){const e=Object.create(null);for(const[r,i]of Object.entries(t)){let t;t="buffer"in i&&!d(i)?{...i,buffer:I(i.buffer)}:{buffer:I(i)},e[r]=t}return e}(r),this.indices=i?(E=i,Array.isArray(E)&&(E=new Uint16Array(E)),d(E)&&(E=new _(E)),E):void 0,this.count=n,this.instances=s,this.uniforms=a,this.textures=o,this._cullFace=l?w[l]:void 0,this._frontFace=u?x[u]:2305,this.blend=c?function(t){var e,r;const i={...F,...null!=(e=t.rgb)?e:t},n={...F,...null!=(r=t.alpha)?r:t};return{rgb:{source:R[i.source],destination:R[i.destination],equation:y[i.equation]},alpha:{source:R[n.source],destination:R[n.destination],equation:y[n.equation]}}}(c):void 0,this.depthTest=h?function(t){var e,r;return{mask:null==(e=t.mask)||e,func:M[null!=(r=t.func)?r:"less"],range:{near:0,far:1,...t.range}}}(h):void 0,this.renderTarget=f}get cullFace(){return this._cullFace}set cullFace(t){this._cullFace=void 0!==t?w[t]:void 0}get frontFace(){return this._frontFace}set frontFace(t){t in x&&(this._frontFace=x[t])}get resources(){return[this.shader,...Object.values(this.attributes).map((t=>t.buffer)),...Object.values(this.textures),this.indices,this.renderTarget].filter(f)}}function I(t){return Array.isArray(t)&&(t=new Float32Array(t)),d(t)&&(t=new A(t)),t}class C{constructor(t){this.id=u(),this.resourceType="shader",this.vertexSource=t.vertexSource,this.fragmentSource=t.fragmentSource}}const N="preserve",L="fixed";class U{constructor(t){var e;this.id=u(),this.resourceType="texture",this.textureType="image",this.size=L,this.numberFormat="u8",this.source=t.source,this.name=t.name,this.alpha=t.alpha||N,this.anisotropy=null!=(e=t.anisotropy)?e:0,this.colorFormat=t.colorFormat||"rgba"}get width(){return this.source.width}get height(){return this.source.height}}class P{constructor(t){var e;this.id=u(),this.resourceType="texture",this.textureType="binary",this.size=L,this.source=t.source,this.name=t.name,this.alpha=t.alpha||N,this.width=t.width,this.height=t.height,this.anisotropy=null!=(e=t.anisotropy)?e:0}get colorFormat(){const t=this.source.length/(this.width*this.height);if(1===t)return"r";if(3===t)return"rgb";if(4===t)return"rgba";throw new o(`Invalid number of color channels for binary texture with ID: ${this.id}. Number of channels must be 1 (R) or 3 (RGB) or 4 (RGBA) but the provided data has ${t} channels.`)}get numberFormat(){return this.source instanceof Uint8Array?"u8":"f32"}}class B{constructor(t){var e;this.id=u(),this.resourceType="texture",this.textureType="render",this.source=null,this.name=t.name,this.alpha=t.alpha||N,this.size=t.size||L,this.width=t.width||("fixed"===this.size?0:1),this.height=t.height||("fixed"===this.size?0:1),this.colorFormat=t.colorFormat,this.numberFormat=t.numberFormat,this.anisotropy=null!=(e=t.anisotropy)?e:0}}function D(t,e){return{width:"fixed"===t.size?t.width||e.width:(t.width||1)*e.width,height:"fixed"===t.size?t.height||e.height:(t.height||1)*e.height}}function O(t,e){if("u32"===e.dataType&&!t.getExtension("OES_element_index_uint"))throw new a("UNSIGNED_INT indices are not supported on this device.");const r=t.createBuffer(),i="buffer"===e.resourceType?t.ARRAY_BUFFER:t.ELEMENT_ARRAY_BUFFER;return t.bindBuffer(i,r),t.bufferData(i,e.source,t.STATIC_DRAW),t.bindBuffer(i,null),r}class G{constructor(t,e,r){this.name=t.name,this.length=t.size,this.location=e;const i=v.get(t.type);if(!i)throw new o(`Type of uniform '${t.name}' is not supported.`);this.meta=i,this._data=this.parseData(r)}parseData(t){if(!t)return new Array(this.meta.length).fill(0);const e=this.meta.length*this.length;if(t.flat().length!==e)throw new o(`Could not set uniform '${this.meta.type} ${this.name}'. Expected data with a length of ${e} but your data has a length of ${t.length}.`);return t}equals(t){const e=this._data,r=t;if(e.length!==r.length)return!1;for(let i=0;i<e.length;i++)if(e[i]!==r[i])return!1;return!0}get data(){return this._data}set data(t){this._data=this.parseData(t)}}function k(t,e){const{meta:r,name:i,location:n,data:s}=e,a=s.flat();if("int"===r.type)switch(r.length){case 1:t.uniform1iv(n,a);break;case 2:t.uniform2iv(n,a);break;case 3:t.uniform3iv(n,a);break;case 4:t.uniform4iv(n,a);break;default:throw new o(`Could not set the value for uniform '${i}'. Make sure its length is between 1 and 4 (inclusive).`)}else if("float"===r.type)switch(r.length){case 1:t.uniform1fv(n,a);break;case 2:t.uniform2fv(n,a);break;case 3:t.uniform3fv(n,a);break;case 4:t.uniform4fv(n,a);break;default:throw new o(`Could not set the value for uniform '${i}'. Make sure its length is between 1 and 4 (inclusive).`)}else switch(r.length){case 4:t.uniformMatrix2fv(n,!1,a);break;case 9:t.uniformMatrix3fv(n,!1,a);break;case 16:t.uniformMatrix4fv(n,!1,a);break;default:throw new o(`Could not set the value for uniform '${i}'. Make sure its length is between 2 and 4 (inclusive).`)}}function V(t,e,r){(function(t){const e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);return!!e&&e.precision>10})(t)&&(r=function(t){return t.replace("precision mediump float;","precision highp float;")}(r));const s=t.createShader(e);if(!s)throw new n("Could not create shader");if(t.shaderSource(s,r),t.compileShader(s),t.getShaderParameter(s,t.COMPILE_STATUS))return s;{const r=t.getShaderInfoLog(s);t.deleteShader(s);const n=e===t.VERTEX_SHADER?"vertex":"fragment";throw new i(`Could not compile ${n} shader. Details: ${r}`)}}function X(t,e){const r=function(t,e,r){const s=t.createProgram();if(!s)throw new n("Could not create program");const a=V(t,t.VERTEX_SHADER,e),o=V(t,t.FRAGMENT_SHADER,r);if(t.attachShader(s,a),t.attachShader(s,o),t.linkProgram(s),t.deleteShader(a),t.deleteShader(o),t.getProgramParameter(s,t.LINK_STATUS))return s;throw new i(`Could not link program. Details: ${t.getProgramInfoLog(s)}`)}(t,e.vertexSource,e.fragmentSource);t.useProgram(r);const s=t.getProgramParameter(r,t.ACTIVE_ATTRIBUTES),a=new Map;for(let i=0;i<s;i++){const e=t.getActiveAttrib(r,i),n=e?t.getAttribLocation(r,e.name):-1;if(!e||-1===n)throw new c(`Could not cache attribute. Could not find attribute or location at index ${i}. This is likely a bug with the renderer.`);const s=v.get(e.type);if(!s)throw new o(`Type of attribute '${e.name}' is not supported.`);t.enableVertexAttribArray(n),a.set(e.name,{location:n,meta:s})}const h=t.getProgramParameter(r,t.ACTIVE_UNIFORMS),l=new Map,u=new Map;let f=0;for(let i=0;i<h;i++){const e=t.getActiveUniform(r,i),n=e?t.getUniformLocation(r,e.name):null;if(!e||!n)throw new c(`Could not cache uniform. Could not find uniform or location at index ${i}. This is likely a bug with the renderer.`);const s=e.name.endsWith("[0]")?e.name.slice(0,-3):e.name;if(e.type===t.SAMPLER_2D||e.type===t.SAMPLER_CUBE){const r=new G(e,n,[f]);l.set(s,r),k(t,r),f++}else{const r=new G(e,n);u.set(s,r),k(t,r)}}return t.useProgram(null),{program:r,attributes:a,textures:l,uniforms:u}}let H;function Y(t,e){return D(e,{width:t.drawingBufferWidth,height:t.drawingBufferHeight})}function z(t,e,r){var i;if("undefined"!=typeof WebGLRenderingContext&&t instanceof WebGLRenderingContext&&"f32"===e.numberFormat&&!t.getExtension("OES_texture_float"))throw new a("No support for floating point textures");const s=t.TEXTURE_2D,o=null!=(i=null==r?void 0:r.texture)?i:t.createTexture();if(!o)throw new n(`Could not create \`WebGLTexture\` for texture: ${function(t){return JSON.stringify(t,(function(t,e){if("resourceType"!==t){if(e instanceof Uint8Array||e instanceof Float32Array){const{length:t}=e;return{length:t}}if(e instanceof HTMLImageElement||e instanceof HTMLVideoElement){const{src:t,width:r,height:i}=e;return{src:t,width:r,height:i}}return e}console.log("stripping resource type",e)}),2)}(e)}`);t.bindTexture(s,o),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,"premultiply"===e.alpha),t.pixelStorei(t.UNPACK_ALIGNMENT,"r"===e.colorFormat?1:4);const c="f32"===e.numberFormat?t.FLOAT:t.UNSIGNED_BYTE,l=function(t,e){if("image"===e.textureType){const t=e.source;if("undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap)return t;if(t instanceof HTMLImageElement)return`${t.src}:${t.currentSrc}:${W(e)}`;if(t instanceof HTMLVideoElement)return`${t.src}:${t.currentSrc}:${t.currentTime}:${W(e)}`}else if("render"===e.textureType){const{width:r,height:i}=Y(t,e);return`${r}:${i}`}}(t,e),u=W(e),f=!r||!l||l!==r.hash,d=j(t,e.colorFormat),E=function(t,e,r){if(!("undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext&&"f32"===r))return j(t,e);switch(e){case"r":throw t.R32F;case"rgb":return t.RGB32F;case"rgba":return t.RGBA32F;default:throw new h(e)}}(t,e.colorFormat,e.numberFormat);if(u&&f)if("image"!==e.textureType){const r=e.source,{width:i,height:n}=Y(t,e);t.texImage2D(s,0,E,i,n,0,d,c,r)}else{const r=e.source;(function(t){return"tagName"in t&&"IMG"===t.tagName})(r)&&function(t){const e=document.createElement("a");return e.href=t,!("data:"===e.protocol||"blob:"===e.protocol)}(r.src)&&!r.crossOrigin&&console.warn(`Fragl warning: ${r.src} image may come from a different origin but you did not set the crossOrigin attribute.`),t.texImage2D(s,0,E,d,c,r)}const m="f32"===e.numberFormat?t.NEAREST:t.LINEAR;t.texParameteri(s,t.TEXTURE_MIN_FILTER,m),t.texParameteri(s,t.TEXTURE_MAG_FILTER,m),t.texParameteri(s,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(s,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE);const{anisotropy:T}=e,g=T?t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"):null;return T&&g&&(null!=H||(H=t.getParameter(g.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),t.texParameterf(t.TEXTURE_2D,g.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(T,H))),t.bindTexture(s,null),{texture:o,hash:l}}function j(t,e){switch(e){case"r":return t.LUMINANCE;case"rgb":return t.RGB;case"rgba":return t.RGBA;default:throw new h(e)}}function W(t){if("image"===t.textureType){const e=t.source;if(e instanceof HTMLImageElement)return e.complete;if(e instanceof HTMLVideoElement)return e.readyState>=2}return!0}class q{constructor(t){this.gl=t,this.maxAttribs=Number(t.getParameter(t.MAX_VERTEX_ATTRIBS)),this.shouldEnable=Array.from({length:this.maxAttribs}).fill(!1),this.hasEnabled=Array.from({length:this.maxAttribs}).fill(!1)}setEnabled(t,e){if(t<0)throw new Error(`Attribute index ${t} is out of bounds`);if(t>=this.maxAttribs)throw new Error(`Attribute index ${t} exceeds the maximum number of attributes supported by this device: ${this.maxAttribs}`);this.shouldEnable[t]=e}update(){for(let t=0;t<this.maxAttribs;t++)this.shouldEnable[t]!==this.hasEnabled[t]&&(this.hasEnabled[t]=this.shouldEnable[t],this.shouldEnable[t]?this.gl.enableVertexAttribArray(t):this.gl.disableVertexAttribArray(t))}reset(){for(let t=0;t<this.maxAttribs;t++)this.shouldEnable[t]=!1}}class ${constructor(t,e){this.gl=t,this.bufferCache=new Map,this.shaderCache=new Map,this.textureCache=new Map,this.handleContextLost=t=>{if(this.onContextLost){let e="No WebGLContextEvent";t&&(e=(null==t?void 0:t.statusMessage)||"No statusMessage"),this.onContextLost(new s(`Error: WebGL context lost - ${e}`))}},this.env=(null==e?void 0:e.env)||window||{devicePixelRatio:1};const r=t.canvas;if(!r)throw new s("Unexpected canvas type: "+typeof r);this.onDispose=null==e?void 0:e.onDispose,this.canvas=r;const[i,n]=this.canvasSize;this.canvas.width=((null==e?void 0:e.width)||i)*this.env.devicePixelRatio,this.canvas.height=((null==e?void 0:e.height)||n)*this.env.devicePixelRatio,this.canvas.addEventListener("webglcontextlost",this.handleContextLost,{once:!0}),this.fbo=t.createFramebuffer(),this.vertexAttribArrayState=new q(t)}flush(){this.gl.flush()}resize(...t){let e,r;"undefined"!=typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?[e=this.canvas.clientWidth,r=this.canvas.clientHeight]=t:[e,r]=t,this.canvas.width=e*this.env.devicePixelRatio,this.canvas.height=r*this.env.devicePixelRatio}load(t){const e=this.gl,r=Array.isArray(t)?t:t.resources;for(const i of r)switch(i.resourceType){case"buffer":case"elements":this.bufferCache.has(i.id)||this.bufferCache.set(i.id,O(e,i));break;case"shader":this.shaderCache.has(i.id)||this.shaderCache.set(i.id,X(e,i));break;case"texture":this.textureCache.has(i.id)||this.textureCache.set(i.id,z(e,i));break;default:throw new h(i)}}update(t){const e=this.gl,r=Array.isArray(t)?t:t.resources;for(const i of r)if("texture"===i.resourceType){const t=this.textureCache.get(i.id);if(!t)throw new s(`Could not update texture with ID: '${i.id}'. Did you remember to use load()?`);this.textureCache.set(i.id,z(e,i,t))}}clear(t,e){var r;const i=this.gl;if(e){const t=null==(r=this.textureCache.get(e.id))?void 0:r.texture;if(!t)throw new s(`Could not find render target with ID: ${e.id}. Did you remember to use load()?`);i.bindFramebuffer(i.FRAMEBUFFER,this.fbo),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,t,0)}else i.bindFramebuffer(i.FRAMEBUFFER,null);const n=Array.isArray(t),a=n?t:t.color,o=n?1:t.depth,c=n?255:t.stencil,h=void 0!==a,l=void 0!==o,u=void 0!==c;h&&i.clearColor(...a),l&&i.clearDepth(o),u&&i.clearStencil(c);const f=(h?i.COLOR_BUFFER_BIT:0)|(l?i.DEPTH_BUFFER_BIT:0)|(u?i.STENCIL_BUFFER_BIT:0);i.clear(f)}render(t){var e,r,i,n,c,h,l;const u=this.gl,f=Array.isArray(t)?t:t.renderables;for(const d of f){const t=this.shaderCache.get(d.shader.id);if(!t)throw new s(`Could not find shader with ID: ${d.shader.id}. Did you remember to use load()?`);if(d.blend){const{rgb:t,alpha:e}=d.blend;u.enable(u.BLEND),u.blendFuncSeparate(t.source,t.destination,e.source,e.destination),u.blendEquationSeparate(t.equation,e.equation)}else u.disable(u.BLEND);if(d.depthTest){const{depthTest:t}=d;u.enable(u.DEPTH_TEST),u.depthMask(t.mask),u.depthFunc(t.func),u.depthRange(t.range.near,t.range.far)}else u.disable(u.DEPTH_TEST);if(d.cullFace?(u.enable(u.CULL_FACE),u.frontFace(d.frontFace),u.cullFace(d.cullFace)):u.disable(u.CULL_FACE),u.useProgram(t.program),d.indices){const t=this.getBuffer(d.indices);u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,t)}else u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,null);const f=d.instances?u.getExtension("ANGLE_instanced_arrays"):null;if(d.instances&&!f)throw new a("Instancing is required but not supported on this device");this.vertexAttribArrayState.reset();for(const[a,{location:o,meta:c}]of t.attributes.entries()){this.vertexAttribArrayState.setEnabled(o,!0);const t=d.attributes[a];if(!t)throw new s(`Could not locate shader attribute ${a} within Renderable's attributes.`);const h=E(null!=(e=t.type)?e:t.buffer.dataType),l=this.getBuffer(t.buffer);u.bindBuffer(u.ARRAY_BUFFER,l),u.vertexAttribPointer(o,c.length,h,null!=(r=t.normalized)&&r,null!=(i=t.stride)?i:0,null!=(n=t.offset)?n:0),d.instances&&t.divisor&&f.vertexAttribDivisorANGLE(o,t.divisor)}this.vertexAttribArrayState.update();const m={...d.uniforms,...this.commonUniforms};for(const[e,r]of t.uniforms.entries()){const t=m[e];if(!t)throw new o(`Could not find a value for uniform '${e}'. Make sure you provide a value.`);r.equals(t)||(r.data=t,k(u,r))}for(const[e,r]of t.textures.entries()){u.activeTexture(u.TEXTURE0+r.data.flat()[0]),u.bindTexture(u.TEXTURE_2D,null);const t=d.textures[e];if(!t)throw new o(`Could not find a texture associated with uniform '${e}'. Make sure you provide a value.`);const i=null==(c=this.textureCache.get(t.id))?void 0:c.texture;if(!i)throw new s(`Could not find texture with ID: ${t.id}. Did you remember to use load()?`);u.bindTexture(u.TEXTURE_2D,i)}if(d.renderTarget){const t=null==(h=this.textureCache.get(d.renderTarget.id))?void 0:h.texture;if(!t)throw new s(`Could not find render target with ID: ${d.renderTarget.id}. Did you remember to use load()?`);const{width:e,height:r}=Y(u,d.renderTarget);u.bindFramebuffer(u.FRAMEBUFFER,this.fbo),u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,t,0),u.viewport(0,0,e,r)}else u.bindFramebuffer(u.FRAMEBUFFER,null),u.viewport(0,0,u.drawingBufferWidth,u.drawingBufferHeight);d.instances?d.indices?f.drawElementsInstancedANGLE(d.primitive,d.indices.length,E(d.indices.dataType),0,d.instances):f.drawArraysInstancedANGLE(d.primitive,0,d.count,d.instances):d.indices?u.drawElements(d.primitive,d.indices.length,E(d.indices.dataType),0):u.drawArrays(d.primitive,0,null!=(l=d.count)?l:0)}}release(t){const e=Array.isArray(t)?t:t.resources;for(const r of e)this.deleteResource(r.id,r.resourceType)}readPixels(t){var e;const r=this.gl;let i;if(t){const n=null==(e=this.textureCache.get(t.id))?void 0:e.texture;if(!n)throw new s(`Could not find render target with ID: ${t.id}. Did you remember to use load()?`);i=Y(r,t),r.bindFramebuffer(r.FRAMEBUFFER,this.fbo),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,n,0)}else r.bindFramebuffer(r.FRAMEBUFFER,null),i={width:r.drawingBufferWidth,height:r.drawingBufferHeight};const n=new Uint8Array(i.width*i.height*4);return r.readPixels(0,0,i.width,i.height,r.RGBA,r.UNSIGNED_BYTE,n),new ImageData(new Uint8ClampedArray(n.buffer),i.width,i.height)}dispose(){var t;const e=this.gl;for(const i of this.bufferCache.keys())this.deleteResource(i,"buffer");for(const i of this.shaderCache.keys())this.deleteResource(i,"shader");for(const i of this.textureCache.keys())this.deleteResource(i,"texture");this.bufferCache.clear(),this.shaderCache.clear(),this.textureCache.clear(),e.deleteFramebuffer(this.fbo),e.bindBuffer(e.ARRAY_BUFFER,null),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),e.bindRenderbuffer(e.RENDERBUFFER,null),e.bindFramebuffer(e.FRAMEBUFFER,null);const r=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);for(let i=0;i<r;i++)e.activeTexture(e.TEXTURE0+i),e.bindTexture(e.TEXTURE_2D,null),e.bindTexture(e.TEXTURE_CUBE_MAP,null);this.canvas.width=this.canvas.height=0,this.canvas.removeEventListener("webglcontextlost",this.handleContextLost),null==(t=this.onDispose)||t.call(this)}deleteResource(t,e){var r;const i=this.gl;switch(e){case"buffer":case"elements":const n=this.bufferCache.get(t)||null;i.deleteBuffer(n),this.bufferCache.delete(t);break;case"shader":const s=this.shaderCache.get(t);i.deleteProgram((null==s?void 0:s.program)||null),this.shaderCache.delete(t);break;case"texture":const a=null==(r=this.textureCache.get(t))?void 0:r.texture;i.deleteTexture(a||null),this.textureCache.delete(t);break;default:throw new h(e)}}getBuffer(t){const e=this.bufferCache.get(t.id);if(!e)throw new s(`Could not find buffer with ID: ${t.id}. Did you remember to use load()?`);return e}get commonUniforms(){return{uResolution:[this.gl.drawingBufferWidth,this.gl.drawingBufferHeight],uViewSize:this.canvasSize,uDevicePixelRatio:[this.env.devicePixelRatio]}}get canvasSize(){return"undefined"!=typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?[this.canvas.clientWidth,this.canvas.clientHeight]:[this.canvas.width,this.canvas.height]}}const K="uPrevResult",Z={attributes:{aPosition:new A(new Float32Array([-1,-1,3,-1,-1,3]))},count:3},J={attributes:{aPosition:new A(new Float32Array([-1,-1,1,1,-1,1,1,1,-1,-1,1,-1]))},count:6};function Q(t){return t.replace(/void\s+main\(\s*\)\s*{([\s\S]*?)}\s*$/,((t,e)=>`void main() {${e}gl_FragColor.rgb *= gl_FragColor.a;\n}`))}function tt(t){return function(t){return Array.isArray(t)}(t)?t:[t]}const et=[],rt=et;function it(t,e,r,i,n=et){const s=n,a=s.find((n=>!t.includes(n.texture)&&e===n.width&&r===n.height&&i===n.size));if(a)return a.texture;const o=function(t,e,r,i){return new B({name:t,width:e,height:r,size:i||"relative",colorFormat:"rgba",numberFormat:"u8"})}(`pooled-render-texture-${s.length.toString()}`,e,r,i);return s.push({texture:o,width:e,height:r,size:i}),o}class nt{constructor(t){this.index=0,this._textures=null!=t?t:[new B({colorFormat:"rgba",numberFormat:"u8"}),new B({colorFormat:"rgba",numberFormat:"u8"})]}get textures(){return this._textures}currentBuffer(){return this._textures[this.index]}nextBuffer(){return this.index=(this.index+1)%this._textures.length,this._textures[this.index]}}const st=class t{static createPingpongBuffers({width:t,height:e,size:r}={}){const i=it([],t,e,r),n=it([i],t,e,r);return new nt([i,n])}constructor({passes:e,uniforms:r,textures:i,options:{buffers:n,renderTarget:s,enableOneTriangleOptimisation:a}={}}){this.enableOneTriangleOptimisation=null!=a?a:t.enableOneTriangleOptimisation;const o=null!=n?n:t.createPingpongBuffers(s),{passes:c,uniforms:h}=this.convertShorthands(e,r);this.uniforms=h;const l=c[c.length-1];this.finalPassShaderForCanvas=this.getShader(l,!0),this.finalPassShaderForRenderTexture=this.getShader(l,!1);const u=this.createRenderTextures(c,o,s);this.renderables=this.getRenderables(c,u,o,i,s)}convertShorthands(t,e){return{passes:t.map((t=>"string"==typeof t?{fragment:t}:t)),uniforms:Object.fromEntries(Object.entries(null!=e?e:{}).map((([t,e])=>[t,tt(e)])))}}createRenderTextures(t,e,r){const i=new Map;for(const n of t)n.output&&i.set(n.output,it([...e.textures,...i.values()],null==r?void 0:r.width,null==r?void 0:r.height,null==r?void 0:r.size));return i}getRenderables(t,e,r,i,n){const s=t.slice(0,-1).map((t=>{const n=this.getShader(t,!1),s=r.currentBuffer(),a=t.output?this.getRenderTexture(t.output,e):r.nextBuffer();return this.getRenderable(t,n,s,a,e,i)})),a=n?this.finalPassShaderForRenderTexture:this.finalPassShaderForCanvas;return[...s,this.getRenderable(t[t.length-1],a,r.currentBuffer(),n,e,i)]}getRenderable(t,e,r,i,n,s){const a=this.uniforms,o=this.getTextures(t,{...s,[K]:r},n),c=this.enableOneTriangleOptimisation?Z:J;return new S({...c,shader:e,uniforms:a,textures:o,renderTarget:i})}getShader(t,e){const r=`\nattribute vec2 aPosition;\nvarying vec2 vTexCoord;\n\nvoid main()\n{\n    gl_Position = vec4(aPosition, 0.0, 1.0);\n    vTexCoord = aPosition * 0.5 + 0.5;\n    ${e?"vTexCoord.y = 1.0 - vTexCoord.y;":""}\n}\n  `,i=this.getFragmentSource(t.fragment,e);return new C({vertexSource:r,fragmentSource:i})}getFragmentSource(t,e){return e?Q(t):t}getRenderTexture(t,e){const r=e.get(t);if(!r)throw new o(`Unable to assign texture. Could not find texture '${t}'.`);return r}getTextures(t,e,r){if(t.inputs)for(const i of t.inputs)e[i]=this.getRenderTexture(i,r);return e}update({textures:t,uniforms:e,renderTarget:r}){if(t)for(const[i,n]of Object.entries(t))if(n)for(const t of this.renderables)t.textures[i]=n;if(e)for(const[i,n]of Object.entries(e))this.uniforms[i]&&(this.uniforms[i]=tt(n));if(void 0!==r){const t=this.renderables[this.renderables.length-1],e=null===r?this.finalPassShaderForCanvas:this.finalPassShaderForRenderTexture;t.renderTarget=null!=r?r:void 0,t.shader=e}}get resources(){return[...new Set([...this.renderables.flatMap((t=>t.resources)),this.finalPassShaderForCanvas,this.finalPassShaderForRenderTexture])]}};st.enableOneTriangleOptimisation=!1;let at,ot,ct=st;function ht(t,e){if(!(at&&ot||(at=document.createElement("canvas"),ot=at.getContext("2d"),ot)))throw new r("Unable to establish `CanvasRenderingContext2D` for debugging");return at.width=t,at.height=e,{canvas:at,context:ot}}function lt(t,e){const r=t.readPixels(e),{width:i,height:n}=r,{canvas:s,context:a}=ht(i,n);a.putImageData(r,0,0);const o=s.toDataURL();dt(null!=e?e:t.canvas,o,i/n)}function ut(t){const{width:e,height:r}=t,{canvas:i,context:n}=ht(e,r);t.source instanceof ImageData?n.putImageData(t.source,0,0):n.drawImage(t.source,0,0);dt(t,i.toDataURL(),e/r)}function ft(t){const{source:e,colorFormat:r,width:i,height:n}=t,{canvas:s,context:a}=ht(i,n),o="rgba"===r,c=a.createImageData(i,n),h=c.data;for(let l=0,u=0;l<e.length;l+=o?4:3,u+=4)h[u]=e[l],h[u+1]=e[l+1],h[u+2]=e[l+2],h[u+3]=o?e[l+3]:255;a.putImageData(c,0,0);dt(t,s.toDataURL(),i/n)}function dt(t,e,r){const i=`\n    font-size: 0;\n    padding-left: 256px;\n    padding-bottom: ${256/r}px;\n    vertical-align: top;\n    background-image: \n      url(${e}),\n      url('data:image/svg+xml,${encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20">\n    <rect width="10" height="10" fill="#ccc"/>\n    <rect x="10" y="10" width="10" height="10" fill="#ccc"/>\n    <rect x="10" y="0" width="10" height="10" fill="white"/>\n    <rect y="10" width="10" height="10" fill="white"/>\n  </svg>')}');\n    background-position: center, 0 0;\n    background-size: contain, 20px 20px;\n    background-repeat: no-repeat, repeat;\n  `;console.group("Debugging",t),console.log("%c ",i),console.groupEnd()}const Et="LkEaxkGQc",mt="mXA59BV4k",Tt="x8cqPYjGq",gt="zAvK5sktl",vt="j5BD_wqsh",pt="Flt8u8M0x",At="m5a6RRSnk",_t="MpMrqOkTf",bt="ihJIFSpvi",Rt="mjiW1vcGg",wt="T1GP6ZTnQ",xt="zztE2SnZx",yt="LPlLw5zPI",Ft="MLGoNA0wv";var Mt=1e-6,St="undefined"!=typeof Float32Array?Float32Array:Array;function It(){var t=new St(9);return St!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function Ct(){var t=new St(16);return St!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function Nt(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Lt(t,e,r){var i=e[0],n=e[1],s=e[2],a=e[3],o=e[4],c=e[5],h=e[6],l=e[7],u=e[8],f=e[9],d=e[10],E=e[11],m=e[12],T=e[13],g=e[14],v=e[15],p=r[0],A=r[1],_=r[2],b=r[3];return t[0]=p*i+A*o+_*u+b*m,t[1]=p*n+A*c+_*f+b*T,t[2]=p*s+A*h+_*d+b*g,t[3]=p*a+A*l+_*E+b*v,p=r[4],A=r[5],_=r[6],b=r[7],t[4]=p*i+A*o+_*u+b*m,t[5]=p*n+A*c+_*f+b*T,t[6]=p*s+A*h+_*d+b*g,t[7]=p*a+A*l+_*E+b*v,p=r[8],A=r[9],_=r[10],b=r[11],t[8]=p*i+A*o+_*u+b*m,t[9]=p*n+A*c+_*f+b*T,t[10]=p*s+A*h+_*d+b*g,t[11]=p*a+A*l+_*E+b*v,p=r[12],A=r[13],_=r[14],b=r[15],t[12]=p*i+A*o+_*u+b*m,t[13]=p*n+A*c+_*f+b*T,t[14]=p*s+A*h+_*d+b*g,t[15]=p*a+A*l+_*E+b*v,t}function Ut(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function Pt(t,e){var r=e[0],i=e[1],n=e[2],s=e[3],a=r+r,o=i+i,c=n+n,h=r*a,l=i*a,u=i*o,f=n*a,d=n*o,E=n*c,m=s*a,T=s*o,g=s*c;return t[0]=1-u-E,t[1]=l+g,t[2]=f-T,t[3]=0,t[4]=l-g,t[5]=1-h-E,t[6]=d+m,t[7]=0,t[8]=f+T,t[9]=d-m,t[10]=1-h-u,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var Bt=function(t,e,r,i,n){var s,a=1/Math.tan(e/2);return t[0]=a/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=n&&n!==1/0?(s=1/(i-n),t[10]=(n+i)*s,t[14]=2*n*i*s):(t[10]=-1,t[14]=-2*i),t};function Dt(t,e,r,i){var n,s,a,o,c,h,l,u,f,d,E=e[0],m=e[1],T=e[2],g=i[0],v=i[1],p=i[2],A=r[0],_=r[1],b=r[2];return Math.abs(E-A)<Mt&&Math.abs(m-_)<Mt&&Math.abs(T-b)<Mt?Nt(t):(l=E-A,u=m-_,f=T-b,n=v*(f*=d=1/Math.hypot(l,u,f))-p*(u*=d),s=p*(l*=d)-g*f,a=g*u-v*l,(d=Math.hypot(n,s,a))?(n*=d=1/d,s*=d,a*=d):(n=0,s=0,a=0),o=u*a-f*s,c=f*n-l*a,h=l*s-u*n,(d=Math.hypot(o,c,h))?(o*=d=1/d,c*=d,h*=d):(o=0,c=0,h=0),t[0]=n,t[1]=o,t[2]=l,t[3]=0,t[4]=s,t[5]=c,t[6]=u,t[7]=0,t[8]=a,t[9]=h,t[10]=f,t[11]=0,t[12]=-(n*E+s*m+a*T),t[13]=-(o*E+c*m+h*T),t[14]=-(l*E+u*m+f*T),t[15]=1,t)}function Ot(){var t=new St(3);return St!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function Gt(t){var e=t[0],r=t[1],i=t[2];return Math.hypot(e,r,i)}function kt(t,e,r){var i=new St(3);return i[0]=t,i[1]=e,i[2]=r,i}function Vt(){var t=new St(4);return St!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}Ot(),function(){var t=function(){var t=new St(4);return St!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}()}();var Xt=function(t,e,r,i){var n=new St(4);return n[0]=t,n[1]=e,n[2]=r,n[3]=i,n};!function(){var t=Ot(),e=kt(1,0,0),r=kt(0,1,0)}(),function(){var t=Vt(),e=Vt()}(),function(){var t=It()}();const Ht=new P({width:1,height:1,source:new Uint8Array([0,0,0,0])});const Yt=t=>{if(void 0===t.camera)return{cameraKind:"perspective",perspective:{aspectRatio:1.7777777,yfov:.39959652046304894,znear:.10000000149011612,zfar:1e3},id:-1,name:"default camera",rotation:[0,0,0,0],scale:[1,1,1],translation:[0,0,.3499999940395355]};const e=void 0!==t.camera.perspective?"perspective":"orthographic";return"perspective"===e?{name:t.name,id:t.id,translation:t.translation,rotation:t.rotation,scale:t.scale,cameraKind:e,perspective:t.camera.perspective}:{name:t.name,id:t.id,translation:t.translation,rotation:t.rotation,scale:t.scale,cameraKind:e,orthographic:t.camera.orthographic}},zt=1313821514,jt=5130562;var Wt=(t=>(t[t.GLTF_BUFFER_TYPE_BYTE=5120]="GLTF_BUFFER_TYPE_BYTE",t[t.GLTF_BUFFER_TYPE_UNSIGNED_BYTE=5121]="GLTF_BUFFER_TYPE_UNSIGNED_BYTE",t[t.GLTF_BUFFER_TYPE_SHORT=5122]="GLTF_BUFFER_TYPE_SHORT",t[t.GLTF_BUFFER_TYPE_UNSIGNED_SHORT=5123]="GLTF_BUFFER_TYPE_UNSIGNED_SHORT",t[t.GLTF_BUFFER_TYPE_UNSIGNED_INT=5125]="GLTF_BUFFER_TYPE_UNSIGNED_INT",t[t.GLTF_BUFFER_TYPE_FLOAT=5126]="GLTF_BUFFER_TYPE_FLOAT",t))(Wt||{});const qt={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},$t={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Kt=async t=>(await fetch(t)).arrayBuffer(),Zt=t=>(new TextDecoder).decode(t);class Jt{constructor(t,e,r){this.chunks=[],this.bufferCache=[],this.imageCache=[],this.baseUrl="",this.gltf=e,this.chunks=r,this.baseUrl=t}async accessorData(t){if(!this.gltf.accessors)throw new Error("No accessors views found.");const e=this.gltf.accessors[t],r=$t[e.type];return{buffer:await this.getBufferViewFromAccessor(e),elementsPerType:r}}async getBufferViewFromAccessor(t){if(void 0!==t.bufferView){const e=await this.bufferViewData(t.bufferView,t.componentType);return t.sparse?new Uint8Array(e):e}const e=$t[t.type],r=qt[t.componentType].BYTES_PER_ELEMENT*e*t.count;return new Uint8Array(r)}async bufferViewData(t,e){if(!this.gltf.bufferViews)throw new Error("No buffer views found.");const r=this.gltf.bufferViews[t],i=await this.getBufferData(r.buffer),n=r.byteLength||0,s=r.byteOffset||0,a=i.buffer,o=i.byteOffset;switch(e){case Wt.GLTF_BUFFER_TYPE_BYTE:return new Int8Array(a,o+s,n);case Wt.GLTF_BUFFER_TYPE_UNSIGNED_BYTE:return new Uint8Array(a,o+s,n);case Wt.GLTF_BUFFER_TYPE_SHORT:return new Int16Array(a,o+s,n/2);case Wt.GLTF_BUFFER_TYPE_UNSIGNED_SHORT:return new Uint16Array(a,o+s,n/2);case Wt.GLTF_BUFFER_TYPE_UNSIGNED_INT:return new Uint32Array(a,o+s,n/4);case Wt.GLTF_BUFFER_TYPE_FLOAT:return new Float32Array(a,o+s,n/4)}return new Uint8Array(a,o+s,n)}async getBufferData(t){if(void 0!==this.bufferCache[t])return this.bufferCache[t];if(!this.gltf.buffers)throw new Error("No buffers found.");const e=this.gltf.buffers[t];if(void 0===e.uri){if(0!==t)throw new Error("GLB container is required to be the first buffer");if(void 0===this.chunks)throw new Error("invalid gltf: buffer has no uri nor is there a GLB buffer");return this.chunks[t]}let r=new ArrayBuffer(0);r=e.uri.includes("data:application")?(t=>{try{const e=t.split("base64,")[1];return Uint8Array.from(atob(e),(t=>t.charCodeAt(0))).buffer}catch{return new ArrayBuffer(0)}})(e.uri):await Kt(this.baseUrl+e.uri);const i=new Uint8Array(r);return this.bufferCache[t]=i,i}async getImageData(t){if(void 0!==this.imageCache[t])return this.imageCache[t];if(!this.gltf.images)throw new Error("No images found.");const e=this.gltf.images[t];let r;if(void 0!==e.bufferView){const t=await this.bufferViewData(e.bufferView,Wt.GLTF_BUFFER_TYPE_BYTE),i=new Blob([t],{type:e.mimeType});r=URL.createObjectURL(i)}else{if(void 0===e.uri)throw new Error("Invalid glTF: image must either have a `uri` or a `bufferView`");r=e.uri.includes("base64")?e.uri:this.baseUrl+e.uri}const i=await(async t=>new Promise(((e,r)=>{const i=new Image;i.onload=()=>{e(i)},i.onerror=t=>{r(t)},i.crossOrigin="anonymous",i.src=t})))(r);return this.imageCache[t]=i,i}}const Qt=t=>{let e="";try{const r=new URL(t),i=r.href.split("/");e=r.href.replace(i[i.length-1],"")}catch{e=""}return e},te=async t=>{let e,r,i=[];if(!(t.startsWith("blob:")||t.startsWith("http://")||t.startsWith("https://")))return console.log("fetch retunr external "),null;try{e=await(async t=>await(await fetch(t)).json())(t),r={magic:"glTF",version:parseFloat(e.asset.version),length:0}}catch{let n=await Kt(t);r=(t=>{const e=new DataView(t,0,12);return{magic:Zt(new Uint8Array(t,0,4)),version:e.getUint32(4,!0),length:e.getUint32(8,!0)}})(n),({json:e,chunks:i}=re(n))}return{json:e,header:r,chunks:i}},ee=async t=>{var e;if("string"!=typeof t)throw new Error("Invalid URI: String is expected.");const r=null!=(e=await te(t))?e:(t=>{try{const e=JSON.parse(t);return{json:e,header:{magic:"glTF",version:parseFloat(e.asset.version),length:0},chunks:[]}}catch{return null}})(t);if(null===r)throw new Error("Failed to fetch data.");const{json:i,header:n,chunks:s}=r;if("glTF"!==n.magic||n.version<2)throw new Error(`File format is not supported! Current header magic: ${n.magic}, version ${n.version}`);if(void 0===i)throw new Error("JSON content not found.");if(void 0===i.asset||parseFloat(i.asset.version)<2)throw new Error("Unsupported asset. glTF versions >= 2.0 are supported.");return{json:i,chunks:s}},re=t=>{const e=[];let r;const i=new DataView(t,12);let n=0;for(;n<i.byteLength;){const s=i.getUint32(n,!0);n+=4;const a=i.getUint32(n,!0);if(n+=4,a===zt){const e=new Uint8Array(t,12+n,s);r=JSON.parse(Zt(e))}else if(a===jt){const r=12+n;e.push(new Uint8Array(t,r,s))}n+=s}return{json:r,chunks:e}},ie="placeholder",ne=t=>t instanceof Uint16Array?5123:t instanceof Uint32Array?5125:5121,se=t=>{const e=[];return t.forEach(((t,r)=>{var i,n;t.name.toLowerCase().includes(ie)?e.push({meshIndex:r,name:t.name}):null!=(i=t.material)&&i.name.toLowerCase().includes(ie)&&e.push({meshIndex:r,name:null==(n=t.material)?void 0:n.name})})),e},ae=t=>{const e=[];return t.forEach((t=>{t.targets.length>0&&e.push(...t.targets)})),e},oe=(t,e)=>{const r=(t=>{const e=[];return t.mesh.forEach(((r,i)=>{const n=r.uvs&&r.uvs.length?r.uvs:new Float32Array(r.positions.length/3*2);e.push({name:t.name+"_"+(i+1).toString(),vertices:r.positions,normals:r.normals,uvs:n,tangent:r.tangent,indices:r.indices,material:r.material,id:i,renderingContextBase:ne(r.indices)})})),e})(t),i=(t=>{let e=0;return t.forEach((t=>{e+=t.positions.length})),e})(t.mesh);return{mesh:r,placeholder:se(r),targets:ae(t.mesh),transform:t.translation.length>0?Ut(Ct(),kt(t.translation[0],t.translation[1],t.translation[2])):Ct(),rotation:t.rotation.length>0?Pt(Ct(),Xt(t.rotation[0],t.rotation[1],t.rotation[2],t.rotation[3])):Ct(),scale:t.scale.length>0?kt(t.scale[0],t.scale[1],t.scale[2]):kt(1,1,1),name:t.name,parrent:e,positionPrevious:new Float32Array(i),positionNext:new Float32Array(i),animation:{rotation:{times:new Uint8Array,values:[],interpolation:""},transform:{times:new Uint8Array,values:[],interpolation:""},scale:{times:new Uint8Array,values:[],interpolation:""},weights:{times:new Uint8Array,values:new Float32Array,targets:[],interpolation:"",positions:[]}},progression:0,extras:t.extras}},ce=(t=-1,e="",r=[])=>({id:t,name:e,children:r,mesh:[],scale:[],rotation:[],translation:[],camera:void 0,extras:{highlightCorrection:1,shadowCorrection:1}});const he=kt(0,1,0),le=[.5*Math.PI,.5*Math.PI];e.AdditiveBlending={source:"src alpha",destination:"one",equation:"add"},e.BinaryTexture=P,e.Buffer=A,e.Effect=ct,e.ElementsBuffer=_,e.FraglAllocationError=n,e.FraglCompilationError=i,e.FraglError=r,e.FraglInternalError=c,e.FraglPlatformError=a,e.FraglRuntimeError=s,e.FraglValidationError=o,e.GltfParser=class{constructor(t){this.src=t,this.camera=ce(),this.cameraModel=Yt(this.camera),this.nodes=[],this.clips=[],this.model=[],this.images=[],this.textures=[],this.samplers=[]}async parse(t={}){return this.model=[],this.asset=await(async t=>{const e=Qt(t),r=await ee(t);return new Jt(e,r.json,r.chunks)})(this.src),this.images=await this.getTextureImages(t.imageFilesToReplace),this.updateTexturesData(),this.camera=ce(),this.nodes=await this.getSubNodes(),this.cameraModel=this.getCameraModel(),this.clips=await this.getClips(),this.model=await this.getModel(),this.updateAnimation(),{camera:this.cameraModel,model:this.model,images:this.images,textures:this.textures,samplers:this.samplers}}async getModel(t,e,r=[]){const i=(void 0===t?this.nodes:t).map((t=>{const i=oe(t,e);return t.children.length>0&&this.getModel(t.children,t,r),i}));return r.push(...await Promise.all(i)),r}updateAnimation(){this.clips.forEach((t=>{t.tracks.forEach((t=>{const e=this.model.findIndex((e=>e.name===t.targetObject));if(e>-1){const r=this.model[e];switch(t.targetProperty.toLocaleLowerCase()){case"translation":r.animation.transform.values=this.decodeVector3Animation(t.values,t.valuesElements),r.animation.transform.times=t.times,r.animation.transform.interpolation=t.interpolation;break;case"rotation":r.animation.rotation.values=this.decodeQuaternionAnimation(t.values,t.valuesElements),r.animation.rotation.times=t.times,r.animation.rotation.interpolation=t.interpolation;break;case"scale":r.animation.scale.values=this.decodeVector3Animation(t.values,t.valuesElements),r.animation.scale.times=t.times,r.animation.scale.interpolation=t.interpolation;break;case"weights":r.targets.length>0&&(r.animation.weights.targets=this.model[e].targets,r.animation.weights.times=t.times,r.animation.weights.values=t.values,r.animation.weights.interpolation=t.interpolation,((t,e)=>{const r=t.values.length/t.targets.length;for(let i=0;i<r;i++){const r=i*t.targets.length,n=[];for(let i=0;i<e;i+=3){n[i]=0,n[i+1]=0,n[i+2]=0;for(let e=0;e<t.targets.length;e++){const s=r+e;n[i]+=t.targets[e].positions[i]*t.values[s],n[i+1]+=t.targets[e].positions[i+1]*t.values[s],n[i+2]+=t.targets[e].positions[i+2]*t.values[s]}}t.positions[i]=new Float32Array(n)}})(r.animation.weights,this.getModelVerticesLength(r.mesh)))}}}))})),this.cameraModel.id>-1&&(this.cameraModel.animation=this.model[this.cameraModel.id].animation,this.model=this.model.filter((t=>!t.name.toLocaleLowerCase().includes("camera"))))}getModelVerticesLength(t){let e=0;return t.forEach((t=>{e+=t.vertices.length})),e}decodeQuaternionAnimation(t,e){const r=[];let i=0;for(let n=0;n<t.length;n+=e){const s=Vt();for(let r=0;r<e;r++)s[r]=t[n+r];r[i]=s,i++}return r}decodeVector3Animation(t,e){const r=[];let i=0;for(let n=0;n<t.length;n+=e){const s=Ot();for(let r=0;r<e;r++)s[r]=t[n+r];r[i]=s,i++}return r}async getClips(t=[]){const e=this.getGltfFromAsset();if(void 0===e.animations)return t;const r=e.animations.map((async t=>{const e=await this.getTracks(t);return{name:t.name,tracks:e}}));return t.push(...await Promise.all(r)),t}getTracks(t){const e=this.getAsset();return Promise.all(t.channels.map((async r=>{var i;const n=t.samplers[r.sampler],s=await e.accessorData(n.input),a=await e.accessorData(n.output);return{targetIndex:r.target.node,targetObject:e.gltf.nodes[r.target.node].name,targetProperty:r.target.path,interpolation:null!=(i=n.interpolation)?i:"LINEAR",times:s.buffer,timesElements:s.elementsPerType,values:a.buffer,valuesElements:a.elementsPerType}})))}getCameraModel(){return Yt(this.camera)}updateTexturesData(){var t;this.textures=[],this.samplers=[];const e=this.getGltfFromAsset();this.samplers=null!=(t=e.samplers)?t:[],void 0!==e.textures&&e.textures.forEach(((t,e)=>{t&&(this.textures[e]={sampler:t.sampler,source:t.source})}))}replaceImages(t,e){const r=e.find((e=>{var r;if(null!=(r=t.name)&&r.includes(e.name))return e}));if(!r)throw new o(`No image file found with the name of: ${t.name}`);return r}async getTextureImages(t){if(void 0===this.asset||void 0===this.asset.gltf.images)return[];const e=this.asset.gltf.images.map((async(e,r)=>{var i;return t?this.replaceImages(e,t):{mimeType:e.mimeType,name:e.name,img:await(null==(i=this.asset)?void 0:i.getImageData(r))}}));return Promise.all(e)}async getSubNodes(t,e){const r=this.getGltfFromAsset(),i=0|r.scene,n=r.scenes[i],s=(void 0===t?n.nodes:t).map((async t=>{const i=r.nodes[t],n=ce(t,i.name);return void 0!==i.children&&(n.children=await this.getSubNodes(i.children,i)),void 0!==i.mesh&&(n.mesh=await this.getSubMesh(r.meshes[i.mesh])),n.rotation=[0,0,0,0],void 0!==i.rotation?n.rotation=i.rotation:void 0!==e&&void 0!==e.rotation&&(n.rotation[0]=n.rotation[0]*e.rotation[0],n.rotation[1]=n.rotation[1]*e.rotation[1],n.rotation[2]=n.rotation[2]*e.rotation[2],n.rotation[3]=n.rotation[3]*e.rotation[3]),n.translation=[0,0,0],void 0!==i.translation?n.translation=i.translation:void 0!==e&&void 0!==e.translation&&(n.translation[0]=n.translation[0]*e.translation[0],n.translation[1]=n.translation[1]*e.translation[1],n.translation[2]=n.translation[2]*e.translation[2]),n.scale=[1,1,1],void 0!==i.scale?n.scale=i.scale:void 0!==e&&void 0!==e.scale&&(n.scale[0]=n.scale[0]*e.scale[0],n.scale[1]=n.scale[1]*e.scale[1],n.scale[2]=n.scale[2]*e.scale[2]),void 0!==i.camera&&(n.camera=r.cameras[i.camera],this.camera=n),n.extras=void 0,void 0!==i.extras&&(n.extras={highlightCorrection:1,shadowCorrection:1},n.extras.highlightCorrection=void 0!==i.extras.Highlight_Correction?i.extras.Highlight_Correction:1,n.extras.shadowCorrection=void 0!==i.extras.Shadow_Correction?i.extras.Shadow_Correction:1),n}));return Promise.all(s)}getMaterial(t){const e=this.getAsset().gltf.materials[t];return void 0!==e.pbrMetallicRoughness&&(void 0===e.pbrMetallicRoughness.metallicFactor&&(e.pbrMetallicRoughness.metallicFactor=1),void 0===e.pbrMetallicRoughness.roughnessFactor&&(e.pbrMetallicRoughness.roughnessFactor=1),void 0===e.pbrMetallicRoughness.baseColorFactor&&(e.pbrMetallicRoughness.baseColorFactor=[1,1,1,1])),e}async getTargets(t){const e=this.getAsset(),r=t.targets.map((async t=>{const r={normals:new Uint8Array(0),positions:new Uint8Array(0),tangent:new Uint8Array(0)};return void 0!==t.POSITION&&(r.positions=(await e.accessorData(t.POSITION)).buffer),void 0!==t.NORMAL&&(r.normals=(await e.accessorData(t.NORMAL)).buffer),void 0!==t.TANGENT&&(r.tangent=(await e.accessorData(t.TANGENT)).buffer),r}));return Promise.all(r)}async getSubMesh(t){const e=this.getAsset(),r=t.primitives.map((async t=>{const r={positions:new Uint8Array(0),normals:new Uint8Array(0),uvs:new Uint8Array(0),tangent:new Uint8Array(0),indices:new Uint8Array(0),targets:[],material:void 0};if(void 0!==t.attributes.POSITION&&(r.positions=(await e.accessorData(t.attributes.POSITION)).buffer),void 0!==t.attributes.NORMAL&&(r.normals=(await e.accessorData(t.attributes.NORMAL)).buffer),void 0!==t.attributes.TEXCOORD_0&&(r.uvs=(await e.accessorData(t.attributes.TEXCOORD_0)).buffer,0===r.uvs.length&&(r.uvs=new Float32Array(r.positions.length/3*2))),void 0!==t.attributes.TANGENT&&(r.tangent=(await e.accessorData(t.attributes.TANGENT)).buffer),void 0!==t.indices){const i=await e.accessorData(t.indices);r.indices=i.buffer}return void 0!==t.targets&&(r.targets=await this.getTargets(t)),void 0!==t.material&&(r.material=this.getMaterial(t.material)),r}));return Promise.all(r)}getAsset(){if(void 0===this.asset)throw new Error("Asset is undefined");return this.asset}getGltfFromAsset(){return this.getAsset().gltf}},e.ImageTexture=U,e.MockWebGLRenderingContext=class{constructor(t){this.canvas=t,this.drawingBufferColorSpace="srgb",this.DEPTH_BUFFER_BIT=256,this.STENCIL_BUFFER_BIT=1024,this.COLOR_BUFFER_BIT=16384,this.POINTS=0,this.LINES=1,this.LINE_LOOP=2,this.LINE_STRIP=3,this.TRIANGLES=4,this.TRIANGLE_STRIP=5,this.TRIANGLE_FAN=6,this.ZERO=0,this.ONE=1,this.SRC_COLOR=768,this.ONE_MINUS_SRC_COLOR=769,this.SRC_ALPHA=770,this.ONE_MINUS_SRC_ALPHA=771,this.DST_ALPHA=772,this.ONE_MINUS_DST_ALPHA=773,this.DST_COLOR=774,this.ONE_MINUS_DST_COLOR=775,this.SRC_ALPHA_SATURATE=776,this.FUNC_ADD=32774,this.BLEND_EQUATION=32777,this.BLEND_EQUATION_RGB=32777,this.BLEND_EQUATION_ALPHA=34877,this.FUNC_SUBTRACT=32778,this.FUNC_REVERSE_SUBTRACT=32779,this.BLEND_DST_RGB=32968,this.BLEND_SRC_RGB=32969,this.BLEND_DST_ALPHA=32970,this.BLEND_SRC_ALPHA=32971,this.CONSTANT_COLOR=32769,this.ONE_MINUS_CONSTANT_COLOR=32770,this.CONSTANT_ALPHA=32771,this.ONE_MINUS_CONSTANT_ALPHA=32772,this.BLEND_COLOR=32773,this.ARRAY_BUFFER=34962,this.ELEMENT_ARRAY_BUFFER=34963,this.ARRAY_BUFFER_BINDING=34964,this.ELEMENT_ARRAY_BUFFER_BINDING=34965,this.STREAM_DRAW=35040,this.STATIC_DRAW=35044,this.DYNAMIC_DRAW=35048,this.BUFFER_SIZE=34660,this.BUFFER_USAGE=34661,this.CURRENT_VERTEX_ATTRIB=34342,this.FRONT=1028,this.BACK=1029,this.FRONT_AND_BACK=1032,this.CULL_FACE=2884,this.BLEND=3042,this.DITHER=3024,this.STENCIL_TEST=2960,this.DEPTH_TEST=2929,this.SCISSOR_TEST=3089,this.POLYGON_OFFSET_FILL=32823,this.SAMPLE_ALPHA_TO_COVERAGE=32926,this.SAMPLE_COVERAGE=32928,this.NO_ERROR=0,this.INVALID_ENUM=1280,this.INVALID_VALUE=1281,this.INVALID_OPERATION=1282,this.OUT_OF_MEMORY=1285,this.CW=2304,this.CCW=2305,this.LINE_WIDTH=2849,this.ALIASED_POINT_SIZE_RANGE=33901,this.ALIASED_LINE_WIDTH_RANGE=33902,this.CULL_FACE_MODE=2885,this.FRONT_FACE=2886,this.DEPTH_RANGE=2928,this.DEPTH_WRITEMASK=2930,this.DEPTH_CLEAR_VALUE=2931,this.DEPTH_FUNC=2932,this.STENCIL_CLEAR_VALUE=2961,this.STENCIL_FUNC=2962,this.STENCIL_FAIL=2964,this.STENCIL_PASS_DEPTH_FAIL=2965,this.STENCIL_PASS_DEPTH_PASS=2966,this.STENCIL_REF=2967,this.STENCIL_VALUE_MASK=2963,this.STENCIL_WRITEMASK=2968,this.STENCIL_BACK_FUNC=34816,this.STENCIL_BACK_FAIL=34817,this.STENCIL_BACK_PASS_DEPTH_FAIL=34818,this.STENCIL_BACK_PASS_DEPTH_PASS=34819,this.STENCIL_BACK_REF=36003,this.STENCIL_BACK_VALUE_MASK=36004,this.STENCIL_BACK_WRITEMASK=36005,this.VIEWPORT=2978,this.SCISSOR_BOX=3088,this.COLOR_CLEAR_VALUE=3106,this.COLOR_WRITEMASK=3107,this.UNPACK_ALIGNMENT=3317,this.PACK_ALIGNMENT=3333,this.MAX_TEXTURE_SIZE=3379,this.MAX_VIEWPORT_DIMS=3386,this.SUBPIXEL_BITS=3408,this.RED_BITS=3410,this.GREEN_BITS=3411,this.BLUE_BITS=3412,this.ALPHA_BITS=3413,this.DEPTH_BITS=3414,this.STENCIL_BITS=3415,this.POLYGON_OFFSET_UNITS=10752,this.POLYGON_OFFSET_FACTOR=32824,this.TEXTURE_BINDING_2D=32873,this.SAMPLE_BUFFERS=32936,this.SAMPLES=32937,this.SAMPLE_COVERAGE_VALUE=32938,this.SAMPLE_COVERAGE_INVERT=32939,this.COMPRESSED_TEXTURE_FORMATS=34467,this.DONT_CARE=4352,this.FASTEST=4353,this.NICEST=4354,this.GENERATE_MIPMAP_HINT=33170,this.BYTE=5120,this.UNSIGNED_BYTE=5121,this.SHORT=5122,this.UNSIGNED_SHORT=5123,this.INT=5124,this.UNSIGNED_INT=5125,this.FLOAT=5126,this.DEPTH_COMPONENT=6402,this.ALPHA=6406,this.RGB=6407,this.RGBA=6408,this.LUMINANCE=6409,this.LUMINANCE_ALPHA=6410,this.UNSIGNED_SHORT_4_4_4_4=32819,this.UNSIGNED_SHORT_5_5_5_1=32820,this.UNSIGNED_SHORT_5_6_5=33635,this.FRAGMENT_SHADER=35632,this.VERTEX_SHADER=35633,this.MAX_VERTEX_ATTRIBS=34921,this.MAX_VERTEX_UNIFORM_VECTORS=36347,this.MAX_VARYING_VECTORS=36348,this.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661,this.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660,this.MAX_TEXTURE_IMAGE_UNITS=34930,this.MAX_FRAGMENT_UNIFORM_VECTORS=36349,this.SHADER_TYPE=35663,this.DELETE_STATUS=35712,this.LINK_STATUS=35714,this.VALIDATE_STATUS=35715,this.ATTACHED_SHADERS=35717,this.ACTIVE_UNIFORMS=35718,this.ACTIVE_ATTRIBUTES=35721,this.SHADING_LANGUAGE_VERSION=35724,this.CURRENT_PROGRAM=35725,this.NEVER=512,this.LESS=513,this.EQUAL=514,this.LEQUAL=515,this.GREATER=516,this.NOTEQUAL=517,this.GEQUAL=518,this.ALWAYS=519,this.KEEP=7680,this.REPLACE=7681,this.INCR=7682,this.DECR=7683,this.INVERT=5386,this.INCR_WRAP=34055,this.DECR_WRAP=34056,this.VENDOR=7936,this.RENDERER=7937,this.VERSION=7938,this.NEAREST=9728,this.LINEAR=9729,this.NEAREST_MIPMAP_NEAREST=9984,this.LINEAR_MIPMAP_NEAREST=9985,this.NEAREST_MIPMAP_LINEAR=9986,this.LINEAR_MIPMAP_LINEAR=9987,this.TEXTURE_MAG_FILTER=10240,this.TEXTURE_MIN_FILTER=10241,this.TEXTURE_WRAP_S=10242,this.TEXTURE_WRAP_T=10243,this.TEXTURE_2D=3553,this.TEXTURE=5890,this.TEXTURE_CUBE_MAP=34067,this.TEXTURE_BINDING_CUBE_MAP=34068,this.TEXTURE_CUBE_MAP_POSITIVE_X=34069,this.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,this.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,this.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,this.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,this.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,this.MAX_CUBE_MAP_TEXTURE_SIZE=34076,this.TEXTURE0=33984,this.TEXTURE1=33985,this.TEXTURE2=33986,this.TEXTURE3=33987,this.TEXTURE4=33988,this.TEXTURE5=33989,this.TEXTURE6=33990,this.TEXTURE7=33991,this.TEXTURE8=33992,this.TEXTURE9=33993,this.TEXTURE10=33994,this.TEXTURE11=33995,this.TEXTURE12=33996,this.TEXTURE13=33997,this.TEXTURE14=33998,this.TEXTURE15=33999,this.TEXTURE16=34e3,this.TEXTURE17=34001,this.TEXTURE18=34002,this.TEXTURE19=34003,this.TEXTURE20=34004,this.TEXTURE21=34005,this.TEXTURE22=34006,this.TEXTURE23=34007,this.TEXTURE24=34008,this.TEXTURE25=34009,this.TEXTURE26=34010,this.TEXTURE27=34011,this.TEXTURE28=34012,this.TEXTURE29=34013,this.TEXTURE30=34014,this.TEXTURE31=34015,this.ACTIVE_TEXTURE=34016,this.REPEAT=10497,this.CLAMP_TO_EDGE=33071,this.MIRRORED_REPEAT=33648,this.FLOAT_VEC2=35664,this.FLOAT_VEC3=35665,this.FLOAT_VEC4=35666,this.INT_VEC2=35667,this.INT_VEC3=35668,this.INT_VEC4=35669,this.BOOL=35670,this.BOOL_VEC2=35671,this.BOOL_VEC3=35672,this.BOOL_VEC4=35673,this.FLOAT_MAT2=35674,this.FLOAT_MAT3=35675,this.FLOAT_MAT4=35676,this.SAMPLER_2D=35678,this.SAMPLER_CUBE=35680,this.VERTEX_ATTRIB_ARRAY_ENABLED=34338,this.VERTEX_ATTRIB_ARRAY_SIZE=34339,this.VERTEX_ATTRIB_ARRAY_STRIDE=34340,this.VERTEX_ATTRIB_ARRAY_TYPE=34341,this.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922,this.VERTEX_ATTRIB_ARRAY_POINTER=34373,this.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975,this.IMPLEMENTATION_COLOR_READ_TYPE=35738,this.IMPLEMENTATION_COLOR_READ_FORMAT=35739,this.COMPILE_STATUS=35713,this.LOW_FLOAT=36336,this.MEDIUM_FLOAT=36337,this.HIGH_FLOAT=36338,this.LOW_INT=36339,this.MEDIUM_INT=36340,this.HIGH_INT=36341,this.FRAMEBUFFER=36160,this.RENDERBUFFER=36161,this.RGBA4=32854,this.RGB5_A1=32855,this.RGBA8=32856,this.RGB565=36194,this.DEPTH_COMPONENT16=33189,this.STENCIL_INDEX8=36168,this.DEPTH_STENCIL=34041,this.RENDERBUFFER_WIDTH=36162,this.RENDERBUFFER_HEIGHT=36163,this.RENDERBUFFER_INTERNAL_FORMAT=36164,this.RENDERBUFFER_RED_SIZE=36176,this.RENDERBUFFER_GREEN_SIZE=36177,this.RENDERBUFFER_BLUE_SIZE=36178,this.RENDERBUFFER_ALPHA_SIZE=36179,this.RENDERBUFFER_DEPTH_SIZE=36180,this.RENDERBUFFER_STENCIL_SIZE=36181,this.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048,this.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049,this.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050,this.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051,this.COLOR_ATTACHMENT0=36064,this.DEPTH_ATTACHMENT=36096,this.STENCIL_ATTACHMENT=36128,this.DEPTH_STENCIL_ATTACHMENT=33306,this.NONE=0,this.FRAMEBUFFER_COMPLETE=36053,this.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054,this.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055,this.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057,this.FRAMEBUFFER_UNSUPPORTED=36061,this.FRAMEBUFFER_BINDING=36006,this.RENDERBUFFER_BINDING=36007,this.MAX_RENDERBUFFER_SIZE=34024,this.INVALID_FRAMEBUFFER_OPERATION=1286,this.UNPACK_FLIP_Y_WEBGL=37440,this.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441,this.CONTEXT_LOST_WEBGL=37442,this.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,this.BROWSER_DEFAULT_WEBGL=37444}get drawingBufferWidth(){return this.canvas.width}get drawingBufferHeight(){return this.canvas.height}activeTexture(){}attachShader(){}bindAttribLocation(){}bindBuffer(){}bindFramebuffer(){}bindRenderbuffer(){}bindTexture(){}blendColor(){}blendEquation(){}blendEquationSeparate(){}blendFunc(){}blendFuncSeparate(){}bufferData(){}bufferSubData(){}checkFramebufferStatus(){return this.FRAMEBUFFER_COMPLETE}clear(){}clearColor(){}clearDepth(){}clearStencil(){}colorMask(){}compileShader(){}compressedTexImage2D(){}compressedTexSubImage2D(){}copyTexImage2D(){}copyTexSubImage2D(){}createBuffer(){return{}}createFramebuffer(){return{}}createProgram(){return{}}createRenderbuffer(){return{}}createShader(){return{}}createTexture(){return{}}cullFace(){}deleteBuffer(){}deleteFramebuffer(){}deleteProgram(){}deleteRenderbuffer(){}deleteShader(){}deleteTexture(){}depthFunc(){}depthMask(){}depthRange(){}detachShader(){}disable(){}disableVertexAttribArray(){}drawArrays(){}drawElements(){}enable(){}enableVertexAttribArray(){}finish(){}flush(){}framebufferRenderbuffer(){}framebufferTexture2D(){}frontFace(){}generateMipmap(){}getActiveAttrib(){return{}}getActiveUniform(){return null}getAttachedShaders(){return[]}getAttribLocation(){return 0}getBufferParameter(){return 0}getContextAttributes(){return{}}getError(){return this.NO_ERROR}getExtension(){return null}getFramebufferAttachmentParameter(){return 0}getParameter(){return 0}getProgramInfoLog(){return""}getProgramParameter(){return{}}getRenderbufferParameter(){return 0}getShaderInfoLog(){return""}getShaderParameter(){return!0}getShaderPrecisionFormat(){return{rangeMin:127,rangeMax:127,precision:127}}getShaderSource(){return""}getSupportedExtensions(){return[]}getTexParameter(){return 0}getUniform(){return 0}getUniformLocation(){return null}getVertexAttrib(){return 0}getVertexAttribOffset(){return 0}hint(){}isBuffer(){return!1}isContextLost(){return!1}isEnabled(){return!1}isFramebuffer(){return!1}isProgram(){return!1}isRenderbuffer(){return!1}isShader(){return!1}isTexture(){return!1}lineWidth(){}linkProgram(){}pixelStorei(){}polygonOffset(){}readPixels(){}renderbufferStorage(){}sampleCoverage(){}scissor(){}shaderSource(){}stencilFunc(){}stencilFuncSeparate(){}stencilMask(){}stencilMaskSeparate(){}stencilOp(){}stencilOpSeparate(){}texImage2D(){}texParameterf(){}texParameteri(){}texSubImage2D(){}uniform1f(){}uniform1fv(){}uniform1i(){}uniform1iv(){}uniform2f(){}uniform2fv(){}uniform2i(){}uniform2iv(){}uniform3f(){}uniform3fv(){}uniform3i(){}uniform3iv(){}uniform4f(){}uniform4fv(){}uniform4i(){}uniform4iv(){}uniformMatrix2fv(){}uniformMatrix3fv(){}uniformMatrix4fv(){}useProgram(){}validateProgram(){}vertexAttrib1f(){}vertexAttrib1fv(){}vertexAttrib2f(){}vertexAttrib2fv(){}vertexAttrib3f(){}vertexAttrib3fv(){}vertexAttrib4f(){}vertexAttrib4fv(){}vertexAttribPointer(){}viewport(){}},e.ModelViewer=class{constructor(t){this._renderables={},this._renderables=t}get renderables(){return Object.values(this._renderables)}get resources(){return this.renderables.flatMap((t=>t.resources))}getUniformsToUpdateView(t,e){return t.getUniformsToUpdateView(e)}updateAll({uniforms:t}){if(t)for(const e of this.renderables)t.uCameraPosition&&(e.uniforms[Ft]=t.uCameraPosition),t.uMVPMatrix&&(e.uniforms[wt]=t.uMVPMatrix),t.uNormalMatrix&&(e.uniforms[yt]=t.uNormalMatrix)}updateOne({id:t,textures:e}){const r=this._renderables[t];if(!r)throw new o(`Renderable with id ${t} not found`);e&&e.uPlaceholderTexture&&(r.textures[pt]=e.uPlaceholderTexture)}},e.ModelViewerGltfData=class{constructor(t,e=!1){this.gltf=t,this.meshes=this.gltf.model.map((t=>t.mesh)).flat(),this.shader=new C({vertexSource:"#extension GL_OES_standard_derivatives:enable\nprecision highp float;attribute vec2 zztE2SnZx;attribute vec3 ihJIFSpvi,mjiW1vcGg;uniform mat4 T1GP6ZTnQ;uniform mat3 LPlLw5zPI;uniform vec3 MLGoNA0wv;varying vec2 m;varying vec3 j,p,L,s;void main(){mat4 a=T1GP6ZTnQ;gl_Position=a*vec4(ihJIFSpvi,1.),j=ihJIFSpvi,s=MLGoNA0wv,m=zztE2SnZx,p=LPlLw5zPI*mjiW1vcGg,L=normalize(mjiW1vcGg);}vec3 l=vec3(1.);",fragmentSource:e?"#extension GL_OES_standard_derivatives:enable\nprecision highp float;uniform vec4 LkEaxkGQc;uniform float x8cqPYjGq,zAvK5sktl;uniform sampler2D j5BD_wqsh,m5a6RRSnk,Flt8u8M0x,MpMrqOkTf;varying vec2 m;varying vec3 j,p,s;uniform ivec4 mXA59BV4k;bool D(){return mXA59BV4k.x==1;}bool E(){return mXA59BV4k.y==1;}bool F(){return mXA59BV4k.z==1;}bool G(){return mXA59BV4k.w==1;}float u(vec3 d,vec3 e,float a){float c=a*a*a*a,b=max(dot(d,e),0.),f=b*b*(c-1.)+1.;return c/(3.141593*f*f);}float v(float b,float c){float a=c+1.,d=a*a*.125;return b/(b*(1.-d)+d);}float w(vec3 a,vec3 b,vec3 c,float d){float e=max(dot(a,c),0.),f=max(dot(a,b),0.);return v(e,d)*v(f,d);}vec3 x(float b,vec3 a){return a+(1.-a)*pow(1.-b,5.);}vec3 H(sampler2D e,vec3 b,const vec2 a,vec3 f){vec3 o=texture2D(e,a).xyz*2.-1.,g=dFdx(b),h=dFdy(b);vec2 i=dFdx(a),k=dFdy(a);vec3 c=normalize(f),d=normalize(g*k.t-h*i.t),n=-normalize(cross(c,d));mat3 q=mat3(d,n,c);return normalize(q*o);}vec3 l=vec3(1.);vec3 r(vec3 I,vec3 a,vec3 b,vec3 c,vec3 k,float d,float n,float J){vec3 e=vec3(.04);e=mix(e,I,n);vec3 f=normalize(c+b);float o=u(a,f,d),q=w(a,b,c,d);vec3 g=x(max(dot(f,b),0.),e),y=g,i=vec3(1.)-y;i*=1.-n;float h=max(dot(a,c),0.);vec3 z=o*q*g;float A=4.*max(dot(a,b),0.)*h+1e-3;vec3 B=z/A,C=i,K=(C+B)*k*h;return J*K;}void main(){vec3 b[6];b[0]=normalize(vec3(0.,0.,1.5)),b[1]=normalize(vec3(-1.,0.,.3)),b[2]=normalize(vec3(1.,0.,.3)),b[3]=normalize(vec3(0.,1.,1.5));vec3 c=p,a=LkEaxkGQc.rgb;float g=LkEaxkGQc.a;if(D())a=texture2D(j5BD_wqsh,m).rgb,g=texture2D(j5BD_wqsh,m).a;c=E()?H(m5a6RRSnk,j,m,p):c;float d=x8cqPYjGq;d=G()?texture2D(MpMrqOkTf,m).r:d;float h=zAvK5sktl;vec3 i=normalize(s-j),e=vec3(0.);e=r(a,c,i,b[0]-j,l,d,h,1.5),e+=r(a,c,i,normalize(b[1]-j),l,d,h,.75),e+=r(a,c,i,normalize(b[2]-j),l,d,h,.75),e+=r(a,c,i,normalize(b[3]-j),l,d,h,.75);if(F()){vec4 f=texture2D(Flt8u8M0x,m);a=g==0.?f.rgb*f.a:f.rgb*f.a+a*(1.-f.a),g=max(g,f.a);}a=pow(a,vec3(2.2));vec3 k=a*e*.45;k=pow(k,vec3(.454545)),gl_FragColor=vec4(k,g);}":"#extension GL_OES_standard_derivatives:enable\nprecision highp float;uniform vec4 LkEaxkGQc;uniform float x8cqPYjGq,zAvK5sktl;uniform sampler2D j5BD_wqsh,m5a6RRSnk,Flt8u8M0x,MpMrqOkTf;varying vec2 m;varying vec3 j,p,s;uniform ivec4 mXA59BV4k;bool D(){return mXA59BV4k.x==1;}bool E(){return mXA59BV4k.y==1;}bool F(){return mXA59BV4k.z==1;}bool G(){return mXA59BV4k.w==1;}float u(vec3 d,vec3 e,float a){float c=a*a*a*a,b=max(dot(d,e),0.),f=b*b*(c-1.)+1.;return c/(3.141593*f*f);}float v(float b,float c){float a=c+1.,d=a*a*.125;return b/(b*(1.-d)+d);}float w(vec3 a,vec3 b,vec3 c,float d){float e=max(dot(a,c),0.),f=max(dot(a,b),0.);return v(e,d)*v(f,d);}vec3 x(float b,vec3 a){return a+(1.-a)*pow(1.-b,5.);}vec3 H(sampler2D e,vec3 b,const vec2 a,vec3 f){vec3 o=texture2D(e,a).xyz*2.-1.,g=dFdx(b),h=dFdy(b);vec2 i=dFdx(a),k=dFdy(a);vec3 c=normalize(f),d=normalize(g*k.t-h*i.t),n=-normalize(cross(c,d));mat3 q=mat3(d,n,c);return normalize(q*o);}vec3 l=vec3(1.);vec3 t(vec3 b,vec3 c,vec3 d,vec3 e,float h){float f=max(dot(c,d),0.);vec3 g=f*e*b,a=g;a=clamp(a,0.,1.);return h*a;}vec3 r(vec3 I,vec3 a,vec3 b,vec3 c,vec3 k,float d,float n,float J){vec3 e=vec3(.04);e=mix(e,I,n);vec3 f=normalize(c+b);float o=u(a,f,d),q=w(a,b,c,d);vec3 g=x(max(dot(f,b),0.),e),y=g,i=vec3(1.)-y;i*=1.-n;float h=max(dot(a,c),0.);vec3 z=o*q*g;float A=4.*max(dot(a,b),0.)*h+1e-3;vec3 B=z/A,C=i,K=(C+B)*k*h;return J*K;}void main(){vec3 a[6];a[0]=normalize(vec3(1.,-.5,1.)),a[1]=normalize(vec3(-1.,1.5,1.)),a[2]=normalize(vec3(.4,.4,-1.)),a[3]=normalize(vec3(0.,-1.,0.)),a[4]=normalize(vec3(-1.,0.,0.)),a[5]=normalize(vec3(1.,0.,0.));vec3 c=p,b=LkEaxkGQc.rgb;float g=LkEaxkGQc.a;if(D())b=texture2D(j5BD_wqsh,m).rgb,g=texture2D(j5BD_wqsh,m).a,b=pow(b,vec3(2.2));c=E()?H(m5a6RRSnk,j,m,p):c;float h=x8cqPYjGq;h=G()?texture2D(MpMrqOkTf,m).r:h;float k=zAvK5sktl;vec3 n=normalize(s-j),i=vec3(0.);i=r(b,c,n,a[0]-j,l,h,k,.1),i+=r(b,c,n,normalize(a[1]-j),l,h,k,.1),i+=r(b,c,n,normalize(a[2]-j),l,h,k,.1);vec3 d=t(b,c,a[0]-j,l,1.);d+=t(b,c,a[1]-j,l,1.),d+=t(b,c,a[2]-j,l,1.45),d+=t(b,c,a[3]-j,l,.65),d+=t(b,c,a[4]-j,l,.65),d+=t(b,c,a[5]-j,l,.25);vec3 e=LkEaxkGQc.rgb;if(F()){vec4 f=texture2D(Flt8u8M0x,m);e=g==0.?f.rgb*f.a:f.rgb*f.a+e*(1.-f.a),e=pow(e,vec3(2.2)),g=max(g,f.a);}vec3 o=e*(d+i);o=pow(o,vec3(.454545)),gl_FragColor=vec4(o,g);}"})}getRenderables(){return Object.fromEntries(this.meshes.map((t=>[t.name,this.gltfMeshToRenderable(t)])))}gltfMeshToRenderable(t){if(!t.material)throw new a("Mesh material not found");const{baseColorFactor:e,baseColorTexture:r,isBaseColorTexture:i,metallicFactor:n,roughnessFactor:s,roughnessTexture:o,isRoughnessTexture:c,normalTexture:h,isNormalTexture:l,placeholder:u,isPlaceholderTexture:f,isDoubleSided:d}=this.gltfMaterialToTextures(t.material,this.gltf.images,this.gltf.textures),E=i?1:0,m=l?1:0,T=f?1:0,g=c?1:0;return new S({attributes:{[bt]:new A(t.vertices),[Rt]:new A(t.normals),[xt]:new A(t.uvs)},textures:{[vt]:r,[pt]:u,[At]:h,[_t]:o},uniforms:{[Ft]:[0,0,0],[Et]:[e[0],e[1],e[2],e[3]],[gt]:[n],[Tt]:[s],[mt]:[E,m,T,g],[wt]:Array.from(Ct()),[yt]:Array.from(It())},shader:this.shader,indices:new _(t.indices),depthTest:{mask:!0,func:"less",range:{near:0,far:1}},...!d&&{cullFace:"back"}})}gltfMaterialToTextures(t,e,r){const i=t.pbrMetallicRoughness.baseColorFactor,n=t.pbrMetallicRoughness.metallicFactor,s=t.pbrMetallicRoughness.roughnessFactor,a=void 0!==t.pbrMetallicRoughness.baseColorTexture,o=t.pbrMetallicRoughness.baseColorTexture?new U({source:e[r[t.pbrMetallicRoughness.baseColorTexture.index].source].img,anisotropy:16}):Ht,c=t.normalTexture?new U({source:e[r[t.normalTexture.index].source].img,anisotropy:16}):Ht,h=void 0!==t.normalTexture,l=t.pbrMetallicRoughness.metallicRoughnessTexture?new U({source:e[r[t.pbrMetallicRoughness.metallicRoughnessTexture.index].source].img,anisotropy:16}):Ht,u=void 0!==t.pbrMetallicRoughness.metallicRoughnessTexture,f=t.name.includes("placeholder");return{baseColorFactor:i,baseColorTexture:o,metallicFactor:n,roughnessFactor:s,roughnessTexture:l,isRoughnessTexture:u,isBaseColorTexture:a,normalTexture:c,isNormalTexture:h,placeholder:Ht,isPlaceholderTexture:f,isDoubleSided:t.doubleSided}}getDataToUpdateAllPlaceholders(t){return this.meshes.filter((t=>{var e;return null==(e=t.material)?void 0:e.name.includes("placeholder")})).map((e=>({id:e.name,textures:{uPlaceholderTexture:new U({source:t,anisotropy:16})}})))}getDataToUpdateSinglePlaceholder(t,e){if(!this.meshes.find((e=>{var r;return e.name===t&&(null==(r=e.material)?void 0:r.name.includes("placeholder"))})))throw new a("Mesh not found");return{id:t,textures:{uPlaceholderTexture:new U({source:e,anisotropy:16})}}}},e.OrbitControls=class{constructor(t,{initialDistance:e,minDistance:r,maxDistance:i,initialRotation:n,rotationTarget:s,enableZooming:a=!1}){if(this.container=t,this.velocity=[0,0],this.mousePosition=[0,0],this.clientSizeRatio=[1,1],this.isMouseDown=!1,this.projectionMatrix=Ct(),this.viewMatrix=Ct(),this.modelMatrix=Ct(),this.modelViewProjectionMatrix=Ct(),this.cameraPosition=Ot(),this.onMouseDown=t=>{t.preventDefault(),this.mousePosition[0]=t.x,this.mousePosition[1]=t.y,this.clientSizeRatio[0]=window.innerWidth/this.container.clientWidth,this.clientSizeRatio[1]=window.innerHeight/this.container.clientHeight,this.isMouseDown=!0},this.onMouseMove=t=>{if(!this.isMouseDown)return;const{x:e,y:r}=t,i=e-this.mousePosition[0],n=r-this.mousePosition[1],s=.3*Math.sqrt(this.distance);this.velocity[0]=i*s*this.clientSizeRatio[0],this.velocity[1]=n*s*this.clientSizeRatio[1],this.mousePosition[0]=e,this.mousePosition[1]=r,this.tick()},this.onMouseUp=t=>{this.isMouseDown=!1,t.target===this.container&&t.preventDefault()},this.onWheelMove=t=>{t.preventDefault(),t.stopPropagation();const{deltaY:e}=t;if(Number.isNaN(e))return;const r=this.distance+e*this.distance*5e-4;this.zoomToDistance(r)},this.toggleZooming=t=>{t?this.container.addEventListener("wheel",this.onWheelMove,!1):this.container.removeEventListener("wheel",this.onWheelMove,!1)},this.tick=()=>{this.rotation[0]+=.01*this.velocity[0],this.rotation[1]-=.01*this.velocity[1],this.rotation[0]=(this.rotation[0]+2*Math.PI)%(2*Math.PI),this.rotation[1]=Math.min(.99*Math.PI,Math.max(.01,this.rotation[1])),this.velocity[0]*=.95,this.velocity[1]*=.95;const t=this.velocity[0]*this.velocity[0],e=this.velocity[1]*this.velocity[1];return Math.sqrt(t+e)<5e-5&&(this.velocity[0]=0,this.velocity[1]=0),this.updateCameraPosition(),this},this.moveToRotation=(t,e)=>{null!=t&&(this.rotation[0]=(t+2*Math.PI)%(2*Math.PI)),null!=e&&(this.rotation[1]=Math.min(.99*Math.PI,Math.max(.01,e))),this.velocity[0]=0,this.velocity[1]=0},this.loadCameraSettings=({initialCameraDistance:t,cameraDistanceRange:e})=>{this.zoomToDistance(t),this.enableZooming&&null!=e?(this.minDistance=e.min,this.maxDistance=e.max,this.toggleZooming(!0)):this.toggleZooming(!1)},this.zoomToDistance=t=>{null!=t&&(this.distance=Math.min(this.maxDistance,Math.max(t,this.minDistance)))},this.checkCamera=()=>{},void 0!==r&&r<=0)throw new o("Invalid value of minDistance. Expected value must be greater than 0.");this.enableZooming=a,this.distance=null!=e?e:1.5,this.minDistance=null!=r?r:.1,this.maxDistance=null!=i?i:20,this.rotationTarget=null!=s?s:"camera",this.rotation=null!=n?n:le,this.updateCameraPosition(),this.container.addEventListener("mousedown",this.onMouseDown,!1),window.addEventListener("mousemove",this.onMouseMove,!1),window.addEventListener("mouseup",this.onMouseUp,!1)}dispose(){this.container.removeEventListener("mousedown",this.onMouseDown,!1),window.removeEventListener("mousemove",this.onMouseMove,!1),window.removeEventListener("mouseup",this.onMouseUp,!1),this.toggleZooming(!1)}getUniformsToUpdateView(t){return{uniforms:{uCameraPosition:[this.cameraPosition[0],this.cameraPosition[1],this.cameraPosition[2]],uMVPMatrix:this.createMVPMatrix(t),uNormalMatrix:this.createNormalMatrix()}}}createViewMatrix(t){if("model"===this.rotationTarget){const e=[0,0,Gt(t)];Dt(this.viewMatrix,e,t,he)}else Dt(this.viewMatrix,t,t,he);return this.viewMatrix}createModelMatrix(){if(Nt(this.modelMatrix),"model"===this.rotationTarget){const[t,e]=this.rotation;(function(t,e,r){var i=Math.sin(r),n=Math.cos(r),s=e[4],a=e[5],o=e[6],c=e[7],h=e[8],l=e[9],u=e[10],f=e[11];e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=s*n+h*i,t[5]=a*n+l*i,t[6]=o*n+u*i,t[7]=c*n+f*i,t[8]=h*n-s*i,t[9]=l*n-a*i,t[10]=u*n-o*i,t[11]=f*n-c*i})(this.modelMatrix,this.modelMatrix,-e+Math.PI/2),function(t,e,r){var i=Math.sin(r),n=Math.cos(r),s=e[0],a=e[1],o=e[2],c=e[3],h=e[8],l=e[9],u=e[10],f=e[11];e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*n-h*i,t[1]=a*n-l*i,t[2]=o*n-u*i,t[3]=c*n-f*i,t[8]=s*i+h*n,t[9]=a*i+l*n,t[10]=o*i+u*n,t[11]=c*i+f*n}(this.modelMatrix,this.modelMatrix,t-Math.PI/2)}return this.modelMatrix}createMVPMatrix(t){this.createModelMatrix(),this.createViewMatrix(this.cameraPosition),Bt(this.projectionMatrix,.4,t,.01,1e3);const e=kt(0,0,0),r=kt(0,1,0);return Dt(this.viewMatrix,this.cameraPosition,e,r),Lt(this.modelViewProjectionMatrix,this.viewMatrix,this.modelMatrix),Lt(this.modelViewProjectionMatrix,this.projectionMatrix,this.modelViewProjectionMatrix),Array.from(this.modelViewProjectionMatrix)}updateCameraPosition(){const[t,e]="camera"===this.rotationTarget?this.rotation:le;this.cameraPosition[0]=this.distance*Math.cos(t)*Math.sin(e),this.cameraPosition[1]=this.distance*Math.cos(e),this.cameraPosition[2]=this.distance*Math.sin(t)*Math.sin(e)}createNormalMatrix(){const t=It();return function(t,e){var r=e[0],i=e[1],n=e[2],s=e[3],a=e[4],o=e[5],c=e[6],h=e[7],l=e[8],u=e[9],f=e[10],d=e[11],E=e[12],m=e[13],T=e[14],g=e[15],v=r*o-i*a,p=r*c-n*a,A=r*h-s*a,_=i*c-n*o,b=i*h-s*o,R=n*h-s*c,w=l*m-u*E,x=l*T-f*E,y=l*g-d*E,F=u*T-f*m,M=u*g-d*m,S=f*g-d*T,I=v*S-p*M+A*F+_*y-b*x+R*w;I&&(I=1/I,t[0]=(o*S-c*M+h*F)*I,t[1]=(c*y-a*S-h*x)*I,t[2]=(a*M-o*y+h*w)*I,t[3]=(n*M-i*S-s*F)*I,t[4]=(r*S-n*y+s*x)*I,t[5]=(i*y-r*M-s*w)*I,t[6]=(m*R-T*b+g*_)*I,t[7]=(T*A-E*R-g*p)*I,t[8]=(E*b-m*A+g*v)*I)}(t,this.modelMatrix),Array.from(t)}},e.PingpongBuffers=nt,e.PremultipliedNormalBlending={source:"one",destination:"one minus src alpha",equation:"add"},e.RenderTexture=B,e.Renderable=S,e.Renderer=class{constructor(t){this.resources=new Map,this.create=t,this.backend=this.createBackend()}createBackend(){const t=this.create();return t.onContextLost=t=>{var e;null==(e=this.onContextLost)||e.call(this,t)},t}load(t){this.backend.load(t);const e=Array.isArray(t)?t:t.resources;for(const r of e)this.resources.set(r.id,r)}update(t){this.backend.update(t)}clear(t,e){this.backend.clear(t,e)}render(t){this.backend.render(t)}readPixels(t){return this.backend.readPixels(t)}flush(){this.backend.flush()}release(t){this.backend.release(t);const e=Array.isArray(t)?t:t.resources;for(const r of e)this.resources.delete(r.id)}dispose(){this.backend.dispose(),this.resources.clear()}restore(){this.backend.dispose(),this.backend=this.createBackend(),this.backend.load(Array.from(this.resources.values()))}resize(...t){const[e,r]=t;if(e===this.canvas.width&&r===this.canvas.height)return;this.backend.resize(...t);const i=Array.from(this.resources.values()).filter((t=>"texture"===t.resourceType&&!t.source&&"relative"===t.size));this.backend.update(i)}get canvas(){return this.backend.canvas}},e.Shader=C,e.WebGlRenderer=$,e._renderTexturePool=rt,e.createWebGlRenderer=function(t,e){var r,i,s;const a=document.createElement("canvas");t.append(a),a.style.width="100%",a.style.height="100%";let o="Unknown";const c=t=>{t.statusMessage&&(o=t.statusMessage)};a.addEventListener("webglcontextcreationerror",c);const h={alpha:null==(r=null==e?void 0:e.alpha)||r,antialias:null==(i=null==e?void 0:e.antialias)||i,depth:null!=(s=null==e?void 0:e.depth)&&s,stencil:!1,preserveDrawingBuffer:!(null==e||!e.preserveDrawingBuffer),powerPreference:"high-performance",failIfMajorPerformanceCaveat:!(null==e||!e.failIfMajorPerformanceCaveat)},l=null!=e&&e.useWebGl2?a.getContext("webgl2",h):a.getContext("webgl",h);if(a.removeEventListener("webglcontextcreationerror",c),!l)throw new n(`A WebGL context could not be created. Reason: ${o}`);return new $(l,{...e,onDispose:()=>{a.remove()}})},e.debugBinaryTexture=ft,e.debugImageTexture=ut,e.debugRenderTexture=lt,e.debugTexture=function(t,e){e&&"render"!==e.textureType?"image"===e.textureType?ut(e):ft(e):lt(t,e)},e.getAbsoluteTextureSize=D,e.getPooledRenderTexture=it,e.injectAlphaPremultiplication=Q,e.paddedTuple=function(t,e,r){if(t.length>r)return t.slice(0,r);const i=[...t];for(;i.length<r;)i.push(e);return i}},453535:(t,e,r)=>{"use strict";function i(t){return t&&"function"==typeof t.schedule}r.d(e,{m:()=>i})},502678:(t,e,r)=>{"use strict";r.d(e,{c:()=>u});var i=r(124105),n=r(168287),s=r(363295),a=r(426242),o=r(928662),c=r(72231),h=r(1408),l=r(410826);function u(t,e){if(null!=t){if((0,o.l)(t))return(0,i.x)(t,e);if((0,c.y)(t))return(0,n.P)(t,e);if((0,h.X)(t))return(0,s.V)(t,e);if((0,l.x)(t)||"string"==typeof t)return(0,a.S)(t,e)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")}},550742:(t,e,r)=>{"use strict";r.d(e,{c:()=>a});var i=r(226260),n=r(750150),s=r(363295);function a(t,e){return e?(0,s.V)(t,e):new i.c((0,n.v)(t))}},621680:(t,e,r)=>{"use strict";t.exports=r(447524)},664191:(t,e,r)=>{"use strict";r.d(e,{i:()=>f});var i=r(750150),n=r(37186),s=r(771909),a=r(190418),o=r(1408),c=r(72231),h=r(47911),l=r(211794),u=r(977305),f=function(t){if(t&&"function"==typeof t[u.s])return(0,a.X)(t);if((0,o.X)(t))return(0,i.v)(t);if((0,c.y)(t))return(0,n.F)(t);if(t&&"function"==typeof t[l.lJ])return(0,s.S)(t);var e=(0,h.G)(t)?"an invalid object":"'"+t+"'";throw new TypeError("You provided "+e+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")}},682560:(t,e,r)=>{"use strict";r.d(e,{_:()=>i});var i=function(){function t(e,r){void 0===r&&(r=t.now),this.SchedulerAction=e,this.now=r}return t.prototype.schedule=function(t,e,r){return void 0===e&&(e=0),new this.SchedulerAction(this,t).schedule(r,e)},t.now=function(){return Date.now()},t}()},692840:(t,e,r)=>{"use strict";r.d(e,{U:()=>s});var i=r(998083),n=r(335679);function s(t){return void 0===t&&(t=null),function(e){return e.lift(new a(t))}}var a=function(){function t(t){this.defaultValue=t}return t.prototype.call=function(t,e){return e.subscribe(new o(t,this.defaultValue))},t}(),o=function(t){function e(e,r){var i=t.call(this,e)||this;return i.defaultValue=r,i.isEmpty=!0,i}return i.C6(e,t),e.prototype._next=function(t){this.isEmpty=!1,this.destination.next(t)},e.prototype._complete=function(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()},e}(n.v)},750150:(t,e,r)=>{"use strict";r.d(e,{v:()=>i});var i=function(t){return function(e){for(var r=0,i=t.length;r<i&&!e.closed;r++)e.next(t[r]);e.complete()}}},771909:(t,e,r)=>{"use strict";r.d(e,{S:()=>n});var i=r(211794),n=function(t){return function(e){for(var r=t[i.lJ]();;){var n=void 0;try{n=r.next()}catch(s){return e.error(s),e}if(n.done){e.complete();break}if(e.next(n.value),e.closed)break}return"function"==typeof r.return&&e.add((function(){r.return&&r.return()})),e}}},799214:(t,e,r)=>{"use strict";r.d(e,{q:()=>s});var i=r(998083),n=r(682560),s=function(t){function e(r,i){void 0===i&&(i=n._.now);var s=t.call(this,r,(function(){return e.delegate&&e.delegate!==s?e.delegate.now():i()}))||this;return s.actions=[],s.active=!1,s.scheduled=void 0,s}return i.C6(e,t),e.prototype.schedule=function(r,i,n){return void 0===i&&(i=0),e.delegate&&e.delegate!==this?e.delegate.schedule(r,i,n):t.prototype.schedule.call(this,r,i,n)},e.prototype.flush=function(t){var e=this.actions;if(this.active)e.push(t);else{var r;this.active=!0;do{if(r=t.execute(t.state,t.delay))break}while(t=e.shift());if(this.active=!1,r){for(;t=e.shift();)t.unsubscribe();throw r}}},e}(n._)},809774:t=>{!function(){"use strict";t.exports={polyfill:function(){var t=window,e=document;if(!("scrollBehavior"in e.documentElement.style)||!0===t.__forceSmoothScrollPolyfill__){var r,i=t.HTMLElement||t.Element,n=468,s={scroll:t.scroll||t.scrollTo,scrollBy:t.scrollBy,elementScroll:i.prototype.scroll||c,scrollIntoView:i.prototype.scrollIntoView},a=t.performance&&t.performance.now?t.performance.now.bind(t.performance):Date.now,o=(r=t.navigator.userAgent,new RegExp(["MSIE ","Trident/","Edge/"].join("|")).test(r)?1:0);t.scroll=t.scrollTo=function(){void 0!==arguments[0]&&(!0!==h(arguments[0])?E.call(t,e.body,void 0!==arguments[0].left?~~arguments[0].left:t.scrollX||t.pageXOffset,void 0!==arguments[0].top?~~arguments[0].top:t.scrollY||t.pageYOffset):s.scroll.call(t,void 0!==arguments[0].left?arguments[0].left:"object"!=typeof arguments[0]?arguments[0]:t.scrollX||t.pageXOffset,void 0!==arguments[0].top?arguments[0].top:void 0!==arguments[1]?arguments[1]:t.scrollY||t.pageYOffset))},t.scrollBy=function(){void 0!==arguments[0]&&(h(arguments[0])?s.scrollBy.call(t,void 0!==arguments[0].left?arguments[0].left:"object"!=typeof arguments[0]?arguments[0]:0,void 0!==arguments[0].top?arguments[0].top:void 0!==arguments[1]?arguments[1]:0):E.call(t,e.body,~~arguments[0].left+(t.scrollX||t.pageXOffset),~~arguments[0].top+(t.scrollY||t.pageYOffset)))},i.prototype.scroll=i.prototype.scrollTo=function(){if(void 0!==arguments[0])if(!0!==h(arguments[0])){var t=arguments[0].left,e=arguments[0].top;E.call(this,this,void 0===t?this.scrollLeft:~~t,void 0===e?this.scrollTop:~~e)}else{if("number"==typeof arguments[0]&&void 0===arguments[1])throw new SyntaxError("Value could not be converted");s.elementScroll.call(this,void 0!==arguments[0].left?~~arguments[0].left:"object"!=typeof arguments[0]?~~arguments[0]:this.scrollLeft,void 0!==arguments[0].top?~~arguments[0].top:void 0!==arguments[1]?~~arguments[1]:this.scrollTop)}},i.prototype.scrollBy=function(){void 0!==arguments[0]&&(!0!==h(arguments[0])?this.scroll({left:~~arguments[0].left+this.scrollLeft,top:~~arguments[0].top+this.scrollTop,behavior:arguments[0].behavior}):s.elementScroll.call(this,void 0!==arguments[0].left?~~arguments[0].left+this.scrollLeft:~~arguments[0]+this.scrollLeft,void 0!==arguments[0].top?~~arguments[0].top+this.scrollTop:~~arguments[1]+this.scrollTop))},i.prototype.scrollIntoView=function(){if(!0!==h(arguments[0])){var r=function(t){for(;t!==e.body&&!1===f(t);)t=t.parentNode||t.host;return t}(this),i=r.getBoundingClientRect(),n=this.getBoundingClientRect();r!==e.body?(E.call(this,r,r.scrollLeft+n.left-i.left,r.scrollTop+n.top-i.top),"fixed"!==t.getComputedStyle(r).position&&t.scrollBy({left:i.left,top:i.top,behavior:"smooth"})):t.scrollBy({left:n.left,top:n.top,behavior:"smooth"})}else s.scrollIntoView.call(this,void 0===arguments[0]||arguments[0])}}function c(t,e){this.scrollLeft=t,this.scrollTop=e}function h(t){if(null===t||"object"!=typeof t||void 0===t.behavior||"auto"===t.behavior||"instant"===t.behavior)return!0;if("object"==typeof t&&"smooth"===t.behavior)return!1;throw new TypeError("behavior member of ScrollOptions "+t.behavior+" is not a valid value for enumeration ScrollBehavior.")}function l(t,e){return"Y"===e?t.clientHeight+o<t.scrollHeight:"X"===e?t.clientWidth+o<t.scrollWidth:void 0}function u(e,r){var i=t.getComputedStyle(e,null)["overflow"+r];return"auto"===i||"scroll"===i}function f(t){var e=l(t,"Y")&&u(t,"Y"),r=l(t,"X")&&u(t,"X");return e||r}function d(e){var r,i,s,o,c=(a()-e.startTime)/n;o=c=c>1?1:c,r=.5*(1-Math.cos(Math.PI*o)),i=e.startX+(e.x-e.startX)*r,s=e.startY+(e.y-e.startY)*r,e.method.call(e.scrollable,i,s),i===e.x&&s===e.y||t.requestAnimationFrame(d.bind(t,e))}function E(r,i,n){var o,h,l,u,f=a();r===e.body?(o=t,h=t.scrollX||t.pageXOffset,l=t.scrollY||t.pageYOffset,u=s.scroll):(o=r,h=r.scrollLeft,l=r.scrollTop,u=c),d({scrollable:o,method:u,startTime:f,startX:h,startY:l,x:i,y:n})}}}}()},868923:(t,e,r)=>{"use strict";r.d(e,{v:()=>a});var i=r(998083),n=r(317261),s=r(335679);function a(t){return void 0===t&&(t=h),function(e){return e.lift(new o(t))}}var o=function(){function t(t){this.errorFactory=t}return t.prototype.call=function(t,e){return e.subscribe(new c(t,this.errorFactory))},t}(),c=function(t){function e(e,r){var i=t.call(this,e)||this;return i.errorFactory=r,i.hasValue=!1,i}return i.C6(e,t),e.prototype._next=function(t){this.hasValue=!0,this.destination.next(t)},e.prototype._complete=function(){if(this.hasValue)return this.destination.complete();var t=void 0;try{t=this.errorFactory()}catch(e){t=e}this.destination.error(t)},e}(s.v);function h(){return new n.G}},928662:(t,e,r)=>{"use strict";r.d(e,{l:()=>n});var i=r(977305);function n(t){return t&&"function"==typeof t[i.s]}},936791:(t,e,r)=>{"use strict";r.d(e,{k:()=>i});var i=function(){function t(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return t.prototype=Object.create(Error.prototype),t}()}}]);
//# sourceMappingURL=sourcemaps/c6ea54cbae3a7a31.vendor.js.map